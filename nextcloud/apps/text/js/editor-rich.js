(window.textWebpackJsonp=window.textWebpackJsonp||[]).push([[197],{104:function(n,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FILE_ACTION_IDENTIFIER=e.FilesWorkspacePlugin=e.registerFileCreate=e.registerFileActionFallback=e.optimalPath=void 0;var o=i(42),a=l(i(114)),r=i(22),s=l(i(38));function l(n){return n&&n.__esModule?n:{default:n}}
/*
 * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */e.FILE_ACTION_IDENTIFIER="Edit with text app";e.optimalPath=function(n,t){const e=n.split("/"),i=t.split("/");for(e.pop();e[0]===i[0];)e.shift(),i.shift();const o=e.fill("..").concat(i),a=t.split("/");return o.length<a.length?o.join("/"):t};e.registerFileCreate=()=>{const n={attach(n){const e=n.fileList;"files"!==e.id&&"files.public"!==e.id||n.addMenuEntry({id:"file",displayName:t("text","New text document"),templateName:t("text","New text document")+".md",iconClass:"icon-filetype-text",fileType:"file",actionHandler(n){e.createFile(n).then((function(n,t){const i=new OCA.Files.FileInfoModel(t);void 0!==OCA.Viewer?OCA.Files.fileActions.triggerAction("view",i,e):void 0===OCA.Viewer&&OCA.Files.fileActions.triggerAction("Edit with text app",i,e)}))}})}};OC.Plugins.register("OCA.Files.NewFileMenu",n)};e.registerFileActionFallback=()=>{const n=document.getElementById("sharingToken")?document.getElementById("sharingToken").value:null,e=document.getElementById("dir").value;if(!n||""!==e){const e=document.createElement("div");e.id="text-viewer-fallback",document.body.appendChild(e);const a=o=>OCA.Files.fileActions.register(o,"Edit with text app",OC.PERMISSION_UPDATE|OC.PERMISSION_READ,(0,r.imagePath)("core","actions/rename"),t=>{const o=window.FileList.findFile(t);Promise.all([Promise.resolve().then(i.t.bind(null,8,7)),Promise.all([i.e(0),i.e(193),i.e(204),i.e(199)]).then(i.bind(null,151))]).then(i=>{const a=window.FileList.getCurrentDirectory()+"/"+t,r=i[0].default;r.prototype.t=window.t,r.prototype.n=window.n,r.prototype.OCA=window.OCA;const s=i[1].default;new r({render:t=>t(s,{props:{fileId:o?o.id:null,active:!0,shareToken:n,relativePath:a,mimeType:o.mimetype}})}).$mount(e)})},t("text","Edit"));for(let n=0;n<o.openMimetypes.length;n++)a(o.openMimetypes[n]),OCA.Files.fileActions.setDefault(o.openMimetypes[n],"Edit with text app")}};const c={el:null,attach(n){"files"!==n.id&&"files.public"!==n.id||(this.el=document.createElement("div"),n.registerHeader({id:"workspace",el:this.el,render:this.render.bind(this),priority:10}))},render(n){"files"!==n.id&&"files.public"!==n.id||Promise.resolve().then(i.t.bind(null,8,7)).then(t=>{const e=t.default;this.el.id="files-workspace-wrapper",e.prototype.t=window.t,e.prototype.n=window.n,e.prototype.OCA=window.OCA;const i=new(e.extend(a.default))({propsData:{path:n.getCurrentDirectory()},store:s.default}).$mount(this.el);n.$el.on("urlChanged",n=>{i.path=n.dir.toString()}),n.$el.on("changeDirectory",n=>{i.path=n.dir.toString()})})}};e.FilesWorkspacePlugin=c},114:function(n,t,e){"use strict";e.r(t);var i=e(40),o=e(17);for(var a in o)["default"].indexOf(a)<0&&function(n){e.d(t,n,(function(){return o[n]}))}(a);e(146);var r=e(12),s=Object(r.a)(o.default,i.a,i.b,!1,null,"374052d2",null);t.default=s.exports},146:function(n,t,e){"use strict";var i=e(19),o=e.n(i),a=e(39),r={insert:"head",singleton:!1};o()(a.a,r),a.a.locals},17:function(n,t,e){"use strict";e.r(t);var i=e(18),o=e.n(i);for(var a in i)["default"].indexOf(a)<0&&function(n){e.d(t,n,(function(){return i[n]}))}(a);t.default=o.a},18:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o=(i=e(75))&&i.__esModule?i:{default:i},a=e(22),r=e(41);const s=!!document.getElementById("isPublic"),l=(0,a.generateOcsUrl)("apps/text"+(s?"/public":""),2)+"workspace";var c={name:"RichWorkspace",components:{EditorWrapper:()=>Promise.all([e.e(193),e.e(202),e.e(194)]).then(e.bind(null,103))},props:{path:{type:String,required:!0}},data:()=>({focus:!1,folder:null,file:null,loaded:!1,ready:!1,autofocus:!1,darkTheme:OCA.Accessibility&&"dark"===OCA.Accessibility.theme,enabled:OCA.Text.RichWorkspaceEnabled}),computed:{shareToken:()=>document.getElementById("sharingToken")?document.getElementById("sharingToken").value:null,canCreate(){return!!(this.folder&&this.folder.permissions&OC.PERMISSION_CREATE)},showEmptyWorkspace(){return(!this.file||this.autofocus&&!this.ready)&&this.canCreate}},watch:{path(){this.getFileInfo()},focus(n){n||document.querySelector("#editor").scrollTo(0,0)}},async mounted(){this.enabled&&this.getFileInfo(),(0,r.subscribe)("Text::showRichWorkspace",()=>{this.enabled=!0,this.getFileInfo()}),(0,r.subscribe)("Text::hideRichWorkspace",()=>{this.enabled=!1})},methods:{unfocus(){},reset(){this.file=null,this.focus=!1,this.$nextTick(()=>{this.creating=!1,this.getFileInfo()})},getFileInfo(){this.loaded=!1,this.autofocus=!1,this.ready=!1;const n={path:this.path};return s&&(n.shareToken=this.shareToken),o.default.get(l,{params:n}).then(n=>{const t=n.data.ocs.data;return this.folder=t.folder||null,this.file=t.file,this.editing=!0,this.loaded=!0,!0}).catch(n=>(n.response.data.ocs&&n.response.data.ocs.data.folder?this.folder=n.response.data.ocs.data.folder:this.folder=null,this.file=null,this.loaded=!0,this.ready=!0,this.creating=!1,!1))},createNew(){this.creating||(this.creating=!0,this.getFileInfo().then(n=>{this.autofocus=!0,n||window.FileList.createFile("Readme.md",{scrollTo:!1,animate:!1}).then((n,t)=>{this.getFileInfo()})}))}}};t.default=c},250:function(n,t,e){"use strict";e.r(t);var i=e(251),o=e.n(i);for(var a in i)["default"].indexOf(a)<0&&function(n){e.d(t,n,(function(){return i[n]}))}(a);t.default=o.a},251:function(n,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(164),a=p(i(178)),r=p(i(831)),s=i(104),l=p(i(832)),c=p(i(833)),d=p(i(834)),u=p(i(835)),A=i(92);function p(n){return n&&n.__esModule?n:{default:n}}var h={name:"MenuBar",components:{EditorMenuBar:o.EditorMenuBar,ActionButton:c.default,PopoverMenu:d.default,Actions:l.default},directives:{Tooltip:a.default,ClickOutside:u.default},props:{editor:{type:Object,required:!1,default:null},isRichEditor:{type:Boolean,default:!0},autohide:{type:Boolean,default:!1},isPublic:{type:Boolean,default:!1},filePath:{type:String,required:!1,default:""}},data:()=>({windowWidth:0,windowHeight:0,forceRecompute:0,submenuVisibility:{},lastImagePath:null,icons:[...r.default]}),computed:{isHiddenInMenu(){return n=>n-this.iconCount>=0},getIconClasses:()=>(n,t)=>{const e={"is-active":"function"==typeof t.isActive&&t.isActive(n)};return e[t.class]=!0,e},disabled:()=>(n,t)=>!1,isChildMenuVisible(){return n=>!!Object.prototype.hasOwnProperty.call(this.submenuVisibility,n.label)&&this.submenuVisibility[n.label]},allIcons(){return this.isPublic?this.icons:[...this.icons,{label:t("text","Insert image"),class:"icon-image",isActive:()=>{},action:n=>{this.showImagePrompt(n.image)}}]},childPopoverMenu(){return(n,t,e,i)=>{const o=[];for(const a in e)o.push({text:e[a].label,icon:e[a].class,action:()=>{e[a].action(t),this.hideChildMenu(i)},active:e[a].isActive(n)});return o}},childIconClasses(){return(n,t)=>{const e=this.childIcon(n,t);return this.getIconClasses(n,e)}},childIcon:()=>(n,t)=>{for(const e in t){const i=t[e];if(i.isActive(n))return i}return t[0]},iconCount(){this.forceRecompute,this.windowWidth;const n=this.$refs.menubar&&this.$refs.menubar.clientWidth>200?this.$refs.menubar.clientWidth:200;return Math.max(Math.floor(n/44)-2,0)},imagePath(){return this.lastImagePath||this.filePath.split("/").slice(0,-1).join("/")}},mounted(){window.addEventListener("resize",this.getWindowWidth),this.checkInterval=setInterval(()=>{const n=this.$refs.menubar&&this.$refs.menubar.clientWidth>0;this.isRichEditor&&n&&this.redrawMenuBar(),this.isRichEditor&&!n||clearInterval(this.checkInterval)},100)},beforeDestroy(){window.removeEventListener("resize",this.getWindowWidth)},methods:{redrawMenuBar(){this.$nextTick(()=>{this.getWindowWidth(),this.forceRecompute++})},clickIcon:(n,t)=>t.action(n),getWindowWidth(n){this.windowWidth=document.documentElement.clientWidth},getWindowHeight(n){this.windowHeight=document.documentElement.clientHeight},hideChildMenu(n){this.$set(this.submenuVisibility,n.label,!1)},toggleChildMenu(n){const t=!!Object.prototype.hasOwnProperty.call(this.submenuVisibility,n.label)&&this.submenuVisibility[n.label];this.$set(this.submenuVisibility,n.label,!t)},showImagePrompt(n){if(!(0,A.getCurrentUser)())return;const e=n;OC.dialogs.filepicker(t("text","Insert an image"),n=>{OC.Files.getClient().getFileInfo(n).then((n,t)=>{this.lastImagePath=t.path;const i={mimetype:t.mimetype,hasPreview:t.hasPreview},o=(0,s.optimalPath)(this.filePath,"".concat(t.path,"/").concat(t.name)).split("/").map(encodeURIComponent).join("/"),a=Object.entries(i).map(([n,t])=>"".concat(n,"=").concat(encodeURIComponent(t))).join("&"),r="".concat(o,"?fileId=").concat(t.id,"#").concat(a);e({src:r,alt:t.name})})},!1,[],!0,void 0,this.imagePath)},showLinkPrompt(n){if(!OC.getCurrentUser())return;const t=n;OC.dialogs.filepicker("Insert a link",n=>{OC.Files.getClient().getFileInfo(n).then((n,e)=>{this.lastLinkPath=e.path;const i=this.optimalPathTo("".concat(e.path,"/").concat(e.name)).split("/").map(encodeURIComponent).join("/"),o="".concat(i,"?fileId=").concat(e.id);t({href:o})})},!1,[],!0,void 0,this.linkPath)},optimalPathTo(n){const t=n.split("/"),e=this.relativePathTo(n).split("/");return e.length<t.length?e.join("/"):n},relativePathTo(n){const t=this.filePath.split("/"),e=n.split("/");for(t.pop();t[0]===e[0];)t.shift(),e.shift();return t.fill("..").concat(e).join("/")}}};e.default=h},252:function(n,t,e){"use strict";e.r(t);var i=e(253),o=e.n(i);for(var a in i)["default"].indexOf(a)<0&&function(n){e.d(t,n,(function(){return i[n]}))}(a);t.default=o.a},253:function(n,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o,a=i(164),r=(o=i(178))&&o.__esModule?o:{default:o},s=i(104);var l={name:"MenuBubble",components:{EditorMenuBubble:a.EditorMenuBubble},directives:{tooltip:r.default},props:{editor:{type:Object,required:!1,default:null},filePath:{type:String,required:!1,default:""}},data:()=>({linkUrl:null,linkMenuIsActive:!1}),methods:{showLinkMenu(n){this.linkUrl=n.href,this.linkMenuIsActive=!0,this.$nextTick(()=>{this.$refs.linkInput.focus()})},hideLinkMenu(){this.linkUrl=null,this.linkMenuIsActive=!1},selectFile(n){if(!OC.getCurrentUser())return;const e=this.filePath.split("/").slice(0,-1).join("/");OC.dialogs.filepicker(t("text","Select file to link to"),t=>{OC.Files.getClient().getFileInfo(t).then((t,e)=>{const i=(0,s.optimalPath)(this.filePath,"".concat(e.path,"/").concat(e.name)).split("/").map(encodeURIComponent).join("/");n({href:"".concat(i,"?fileId=").concat(e.id)}),this.hideLinkMenu()})},!1,[],!0,void 0,e)},setLinkUrl(n,t){t&&![/^[a-zA-Z]+:/,/^\//,/\?fileId=/,/^\.\.?\//,/^[^.]*[/$]/,/^#/].find(n=>t.match(n))&&(t="https://"+t),n({href:t}),this.hideLinkMenu()}}};e.default=l},39:function(n,t,e){"use strict";var i=e(20),o=e.n(i),a=e(21),r=e.n(a)()(o.a);r.push([n.i,"#rich-workspace[data-v-374052d2]{padding:0 50px;margin-bottom:-24px;text-align:left;max-height:0;transition:max-height 0.5s cubic-bezier(0, 1, 0, 1)}#rich-workspace.creatable[data-v-374052d2]{min-height:90px}#rich-workspace[data-v-374052d2]:only-child{margin-bottom:0}.empty-workspace[data-v-374052d2]{padding-top:43px;color:var(--color-text-maxcontrast);height:0}#rich-workspace[data-v-374052d2] div[contenteditable=false]{width:100%;padding:0px;background-color:var(--color-main-background);opacity:1;border:none}#rich-workspace[data-v-374052d2] #editor-container{height:100%;position:unset !important;top:auto !important}#rich-workspace[data-v-374052d2] #editor-wrapper{position:unset !important;overflow:visible}#rich-workspace[data-v-374052d2] #editor{overflow:scroll !important;max-height:50vh;padding-left:10px}#rich-workspace[data-v-374052d2] #editor-wrapper .ProseMirror{padding:0px;margin:0}#rich-workspace[data-v-374052d2] .menubar{z-index:50;margin-bottom:-10px}#rich-workspace[data-v-374052d2] .menubar .menubar-icons{margin-left:0}#rich-workspace[data-v-374052d2] .editor__content{margin:0}#rich-workspace.focus[data-v-374052d2]{max-height:50vh}#rich-workspace[data-v-374052d2]:not(.focus){max-height:30vh;position:relative;overflow:hidden}#rich-workspace[data-v-374052d2]:not(.focus):not(.icon-loading):after{content:'';position:absolute;z-index:1;bottom:0;left:0;pointer-events:none;background-image:linear-gradient(to bottom, rgba(255,255,255,0), var(--color-main-background));width:100%;height:4em}#rich-workspace.dark[data-v-374052d2]:not(.focus):not(.icon-loading):after{background-image:linear-gradient(to bottom, rgba(0,0,0,0), var(--color-main-background))}@media only screen and (max-width: 1024px){#rich-workspace[data-v-374052d2]:not(.focus){max-height:30vh}}html.ie #rich-workspace[data-v-374052d2] #editor-container{position:initial}html.ie #rich-workspace[data-v-374052d2] #editor-wrapper{position:relative !important;top:auto !important}html.ie #rich-workspace[data-v-374052d2] #editor{display:flex;flex-direction:column;overflow:hidden !important}html.ie #rich-workspace[data-v-374052d2] .menubar{position:relative;overflow:hidden;flex-shrink:0;height:44px;top:auto}html.ie #rich-workspace[data-v-374052d2] #editor>div:nth-child(2){min-height:44px;overflow-x:hidden;overflow-y:auto;flex-shrink:1}\n","",{version:3,sources:["webpack://./src/views/RichWorkspace.vue"],names:[],mappings:"AA0KA,iCACC,cAAe,CAEf,mBAAoB,CACpB,eAAgB,CAChB,YAAa,CACb,mDAAoD,CANrD,2CAQE,eAAgB,CAChB,4CAKD,eAAgB,CAChB,kCAGA,gBAAiB,CACjB,mCAAoC,CACpC,QAAS,CACT,4DAGA,UAAW,CACX,WAAY,CACZ,6CAA8C,CAC9C,SAAU,CACV,WAAY,CACZ,mDAGA,WAAY,CACZ,yBAA0B,CAC1B,mBAAoB,CACpB,iDAGA,yBAA0B,CAC1B,gBAAiB,CACjB,yCAGA,0BAA2B,CAC3B,eAAgB,CAChB,iBAAkB,CAClB,8DAGA,WAAY,CACZ,QAAS,CACT,0CAGA,UAAW,CAEX,mBAAoB,CACpB,yDAGA,aAAc,CACd,kDAGA,QAAS,CACT,uCAGA,eAAgB,CAChB,6CAGA,eAAgB,CAChB,iBAAkB,CAClB,eAAgB,CAChB,sEAGA,UAAW,CACX,iBAAkB,CAClB,SAAU,CACV,QAAS,CACT,MAAO,CACP,mBAAoB,CACpB,8FAAkG,CAClG,UAAW,CACX,UAAW,CACX,2EAGA,wFAA4F,CAC5F,2CAGA,6CACC,eAAgB,CAChB,CAGF,2DAGG,gBAAiB,CAHpB,yDAOG,4BAA6B,CAC7B,mBAAoB,CARvB,iDAYG,YAAa,CACb,qBAAsB,CACtB,0BAA2B,CAd9B,kDAkBG,iBAAkB,CAClB,eAAgB,CAChB,aAAc,CACd,WAAY,CACZ,QAAS,CAtBZ,kEA0BG,eAAgB,CAChB,iBAAkB,CAClB,eAAgB,CAChB,aAAc",sourcesContent:["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n#rich-workspace {\n\tpadding: 0 50px;\n\t/* Slightly reduce vertical space */\n\tmargin-bottom: -24px;\n\ttext-align: left;\n\tmax-height: 0;\n\ttransition: max-height 0.5s cubic-bezier(0, 1, 0, 1);\n\t&.creatable {\n\t\tmin-height: 90px;\n\t}\n}\n\n/* For subfolders, where there are no Recommendations */\n#rich-workspace:only-child {\n\tmargin-bottom: 0;\n}\n\n.empty-workspace {\n\tpadding-top: 43px;\n\tcolor: var(--color-text-maxcontrast);\n\theight: 0;\n}\n\n#rich-workspace::v-deep div[contenteditable=false] {\n\twidth: 100%;\n\tpadding: 0px;\n\tbackground-color: var(--color-main-background);\n\topacity: 1;\n\tborder: none;\n}\n\n#rich-workspace::v-deep #editor-container {\n\theight: 100%;\n\tposition: unset !important;\n\ttop: auto !important;\n}\n\n#rich-workspace::v-deep #editor-wrapper {\n\tposition: unset !important;\n\toverflow: visible;\n}\n\n#rich-workspace::v-deep #editor {\n\toverflow: scroll !important;\n\tmax-height: 50vh;\n\tpadding-left: 10px;\n}\n\n#rich-workspace::v-deep #editor-wrapper .ProseMirror {\n\tpadding: 0px;\n\tmargin: 0;\n}\n\n#rich-workspace::v-deep .menubar {\n\tz-index: 50;\n\t/* Slightly reduce vertical space */\n\tmargin-bottom: -10px;\n}\n\n#rich-workspace::v-deep .menubar .menubar-icons {\n\tmargin-left: 0;\n}\n\n#rich-workspace::v-deep .editor__content {\n\tmargin: 0;\n}\n\n#rich-workspace.focus {\n\tmax-height: 50vh;\n}\n\n#rich-workspace:not(.focus) {\n\tmax-height: 30vh;\n\tposition: relative;\n\toverflow: hidden;\n}\n\n#rich-workspace:not(.focus):not(.icon-loading):after {\n\tcontent: '';\n\tposition: absolute;\n\tz-index: 1;\n\tbottom: 0;\n\tleft: 0;\n\tpointer-events: none;\n\tbackground-image: linear-gradient(to bottom, rgba(255, 255, 255, 0), var(--color-main-background));\n\twidth: 100%;\n\theight: 4em;\n}\n\n#rich-workspace.dark:not(.focus):not(.icon-loading):after {\n\tbackground-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), var(--color-main-background));\n}\n\n@media only screen and (max-width: 1024px) {\n\t#rich-workspace:not(.focus) {\n\t\tmax-height: 30vh;\n\t}\n}\n\nhtml.ie {\n\t#rich-workspace::v-deep {\n\t\t#editor-container {\n\t\t\tposition: initial;\n\t\t}\n\n\t\t#editor-wrapper {\n\t\t\tposition: relative !important;\n\t\t\ttop: auto !important;\n\t\t}\n\n\t\t#editor {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\toverflow: hidden !important;\n\t\t}\n\n\t\t.menubar {\n\t\t\tposition: relative;\n\t\t\toverflow: hidden;\n\t\t\tflex-shrink: 0;\n\t\t\theight: 44px;\n\t\t\ttop: auto;\n\t\t}\n\n\t\t#editor > div:nth-child(2) {\n\t\t\tmin-height: 44px;\n\t\t\toverflow-x: hidden;\n\t\t\toverflow-y: auto;\n\t\t\tflex-shrink: 1;\n\t\t}\n\t}\n}\n\n"],sourceRoot:""}]),t.a=r},40:function(n,t,e){"use strict";e.d(t,"a",(function(){return i})),e.d(t,"b",(function(){return o}));var i=function(){var n=this,t=n.$createElement,e=n._self._c||t;return n.enabled?e("div",{class:{"icon-loading":!n.loaded||!n.ready,focus:n.focus,dark:n.darkTheme,creatable:n.canCreate},attrs:{id:"rich-workspace"}},[n.showEmptyWorkspace?e("div",{staticClass:"empty-workspace",on:{click:n.createNew}},[e("p",{staticClass:"placeholder"},[n._v("\n\t\t\t"+n._s(n.t("text","Add notes, lists or links …"))+"\n\t\t")])]):n._e(),n._v(" "),n.file?e("EditorWrapper",{directives:[{name:"show",rawName:"v-show",value:n.ready,expression:"ready"}],key:n.file.id,attrs:{"file-id":n.file.id,"relative-path":n.file.path,"share-token":n.shareToken,active:!0,autohide:!0,mime:n.file.mimetype,autofocus:n.autofocus},on:{ready:function(t){n.ready=!0},focus:function(t){n.focus=!0},blur:n.unfocus,error:n.reset}}):n._e()],1):n._e()},o=[]},42:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openMimetypesPlainText=t.openMimetypesMarkdown=t.openMimetypes=void 0;
/*
 * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */
const i=["text/markdown"];t.openMimetypesMarkdown=i;const o=["text/plain","application/cmd","application/x-empty","application/x-msdos-program","application/javascript","application/json","application/x-perl","application/x-php","application/x-tex","application/xml","application/yaml","text/css","text/csv","text/html","text/org","text/x-c","text/x-c++src","text/x-h","text/x-java-source","text/x-ldif","text/x-python","text/x-shellscript"];t.openMimetypesPlainText=o;const a=[...i,...o];t.openMimetypes=a},830:function(n,t,e){"use strict";e.r(t);var i=e(891),o=e(250);for(var a in o)["default"].indexOf(a)<0&&function(n){e.d(t,n,(function(){return o[n]}))}(a);e(892);var r=e(12),s=Object(r.a)(o.default,i.a,i.b,!1,null,"0f96f50e",null);t.default=s.exports},831:function(n,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;
/*
 * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>
 *
 * @author Julius Härtl <jus@bitgrid.net>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */
var o=[{label:t("text","Undo"),class:"icon-undo",isActive:n=>!1,isDisabled:n=>0===n.undoDepth(),action:n=>n.undo()},{label:t("text","Redo"),class:"icon-redo",isActive:n=>!1,isDisabled:n=>0===n.redoDepth(),action:n=>n.redo()},{label:t("text","Bold"),class:"icon-bold",isActive:n=>n.strong(),action:n=>n.strong()},{label:t("text","Italic"),class:"icon-italic",isActive:n=>n.em(),action:n=>n.em()},{label:t("text","Strikethrough"),class:"icon-strike",isActive:n=>n.strike(),action:n=>n.strike()},{label:t("text","Headings"),visible:!1,children:[{label:t("text","Heading 1"),class:"icon-h1",isActive:n=>n.heading({level:1}),action:n=>n.heading({level:1})},{label:t("text","Heading 2"),class:"icon-h2",isActive:n=>n.heading({level:2}),action:n=>n.heading({level:2})},{label:t("text","Heading 3"),class:"icon-h3",isActive:n=>n.heading({level:3}),action:n=>n.heading({level:3})},{label:t("text","Heading 4"),class:"icon-h4",isActive:n=>n.heading({level:4}),action:n=>n.heading({level:4})},{label:t("text","Heading 5"),class:"icon-h5",isActive:n=>n.heading({level:5}),action:n=>n.heading({level:5})},{label:t("text","Heading 6"),class:"icon-h6",isActive:n=>n.heading({level:6}),action:n=>n.heading({level:6})}]},{label:t("text","Unordered list"),class:"icon-ul",isActive:n=>n.bullet_list(),action:n=>n.bullet_list_item()},{label:t("text","Ordered list"),class:"icon-ol",isActive:n=>n.ordered_list(),action:n=>n.ordered_list()},{label:t("text","ToDo list"),class:"icon-checkmark",isActive:n=>!1,action:n=>n.todo_item()},{label:t("text","Blockquote"),class:"icon-quote",isActive:n=>n.blockquote(),action:n=>n.blockquote()},{label:t("text","Code block"),class:"icon-code",isActive:n=>n.code_block(),action:n=>n.code_block()}];e.default=o},836:function(n,t,e){"use strict";var i=e(20),o=e.n(i),a=e(21),r=e.n(a)()(o.a);r.push([n.i,".menubar[data-v-0f96f50e]{--background-blur: blur(10px);position:fixed;position:-webkit-sticky;position:sticky;top:0;display:flex;justify-content:flex-end;z-index:10021;background-color:var(--color-main-background-translucent);-webkit-backdrop-filter:var(--background-blur);backdrop-filter:var(--background-blur);min-height:50px;padding-top:3px;padding-bottom:3px}.menubar.autohide[data-v-0f96f50e]{visibility:hidden;opacity:0;transition:visibility 0.2s 0.4s, opacity 0.2s 0.4s}.menubar.autohide.is-focused[data-v-0f96f50e]{visibility:visible;opacity:1}.menubar .menubar-icons[data-v-0f96f50e]{flex-grow:1;margin-left:calc((100% - 660px) / 2)}@media (max-width: 660px){.menubar .menubar-icons[data-v-0f96f50e]{margin-left:0}}.menubar[data-v-0f96f50e] .action-item__menu ul{max-height:calc(100vh - 88px);overflow:scroll}.menubar button[data-v-0f96f50e]{position:relative;width:44px;height:44px;margin:0;background-size:16px;border:0;background-color:transparent;opacity:.5;color:var(--color-main-text);background-position:center center;vertical-align:top}.menubar button[data-v-0f96f50e]:hover,.menubar button[data-v-0f96f50e]:focus,.menubar button[data-v-0f96f50e]:active{background-color:var(--color-background-dark)}.menubar button.is-active[data-v-0f96f50e]::before{transform:translateX(-50%);border-radius:100%;position:absolute;background:var(--color-primary-element);bottom:3px;height:6px;width:6px;content:'';left:50%}.menubar button.is-active[data-v-0f96f50e],.menubar button[data-v-0f96f50e]:hover,.menubar button[data-v-0f96f50e]:focus{opacity:1}.menubar button.icon-undo[data-v-0f96f50e],.menubar button.icon-redo[data-v-0f96f50e]{opacity:.8}.menubar button.icon-undo[data-v-0f96f50e]:disabled,.menubar button.icon-redo[data-v-0f96f50e]:disabled{opacity:.4}.menubar .submenu[data-v-0f96f50e]{display:inline-block;width:44px;height:44px;position:relative;vertical-align:top}\n","",{version:3,sources:["webpack://./src/components/MenuBar.vue"],names:[],mappings:"AAqUA,0BACC,6BAAkB,CAClB,cAAe,CACf,uBAAwB,CACxB,eAAgB,CAChB,KAAM,CACN,YAAa,CACb,wBAAyB,CACzB,aAAc,CACd,yDAA0D,CAC1D,8CAA+C,CAC/C,sCAAuC,CACvC,eAAgB,CAChB,eAAe,CACf,kBAAmB,CAdpB,mCAiBE,iBAAkB,CAClB,SAAU,CACV,kDAAmD,CAnBrD,8CAqBG,kBAAmB,CACnB,SAAU,CAtBb,yCA0BE,WAAY,CACZ,oCAAqC,CACrC,0BA5BF,yCA+BG,aAAc,CACd,CAhCH,gDAmCE,6BAA8B,CAC9B,eAAgB,CAChB,iCAID,iBAAkB,CAClB,UAAW,CACX,WAAY,CACZ,QAAS,CACT,oBAAqB,CACrB,QAAS,CACT,4BAA6B,CAC7B,UAAW,CACX,4BAA6B,CAC7B,iCAAkC,CAClC,kBAAmB,CAXpB,sHAaE,6CAA8C,CAbhD,mDAiBE,0BAA2B,CAC3B,kBAAmB,CACnB,iBAAkB,CAClB,uCAAwC,CACxC,UAAW,CACX,UAAW,CACX,SAAU,CACV,UAAW,CACX,QAAS,CAzBX,yHA+BE,SAAU,CA/BZ,sFAoCE,UAAW,CApCb,wGAuCG,UAAW,CACX,mCAKF,oBAAqB,CACrB,UAAW,CACX,WAAY,CACZ,iBAAkB,CAClB,kBAAmB",sourcesContent:["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.menubar {\n\t--background-blur: blur(10px);\n\tposition: fixed;\n\tposition: -webkit-sticky;\n\tposition: sticky;\n\ttop: 0;\n\tdisplay: flex;\n\tjustify-content: flex-end;\n\tz-index: 10021; // above modal-header and menububble so menubar is always on top\n\tbackground-color: var(--color-main-background-translucent);\n\t-webkit-backdrop-filter: var(--background-blur);\n\tbackdrop-filter: var(--background-blur);\n\tmin-height: 50px; // important for mobile so that the buttons are always inside the container\n\tpadding-top:3px;\n\tpadding-bottom: 3px;\n\n\t&.autohide {\n\t\tvisibility: hidden;\n\t\topacity: 0;\n\t\ttransition: visibility 0.2s 0.4s, opacity 0.2s 0.4s;\n\t\t&.is-focused {\n\t\t\tvisibility: visible;\n\t\t\topacity: 1;\n\t\t}\n\t}\n\t.menubar-icons {\n\t\tflex-grow: 1;\n\t\tmargin-left: calc((100% - 660px) / 2);\n\t}\n\t@media (max-width: 660px) {\n\t\t.menubar-icons {\n\t\t\tmargin-left: 0;\n\t\t}\n\t}\n\t&::v-deep .action-item__menu ul {\n\t\tmax-height: calc(100vh - 88px);\n\t\toverflow: scroll;\n\t}\n}\n\n.menubar button {\n\tposition: relative;\n\twidth: 44px;\n\theight: 44px;\n\tmargin: 0;\n\tbackground-size: 16px;\n\tborder: 0;\n\tbackground-color: transparent;\n\topacity: .5;\n\tcolor: var(--color-main-text);\n\tbackground-position: center center;\n\tvertical-align: top;\n\t&:hover, &:focus, &:active {\n\t\tbackground-color: var(--color-background-dark);\n\t}\n\n\t&.is-active::before {\n\t\ttransform: translateX(-50%);\n\t\tborder-radius: 100%;\n\t\tposition: absolute;\n\t\tbackground: var(--color-primary-element);\n\t\tbottom: 3px;\n\t\theight: 6px;\n\t\twidth: 6px;\n\t\tcontent: '';\n\t\tleft: 50%;\n\n\t}\n\t&.is-active,\n\t&:hover,\n\t&:focus {\n\t\topacity: 1;\n\t}\n\n\t&.icon-undo,\n\t&.icon-redo {\n\t\topacity: .8;\n\n\t\t&:disabled {\n\t\t\topacity: .4;\n\t\t}\n\t}\n}\n\n.menubar .submenu {\n\tdisplay: inline-block;\n\twidth: 44px;\n\theight: 44px;\n\tposition: relative;\n\tvertical-align: top;\n}\n"],sourceRoot:""}]),t.a=r},837:function(n,t,e){"use strict";e.r(t);var i=e(893),o=e(252);for(var a in o)["default"].indexOf(a)<0&&function(n){e.d(t,n,(function(){return o[n]}))}(a);e(894);var r=e(12),s=Object(r.a)(o.default,i.a,i.b,!1,null,"7a686b54",null);t.default=s.exports},838:function(n,t,e){"use strict";var i=e(20),o=e.n(i),a=e(21),r=e.n(a)()(o.a);r.push([n.i,".menububble[data-v-7a686b54]{position:absolute;display:flex;z-index:10020;background:var(--color-main-background-translucent);box-shadow:0 1px 5px var(--color-box-shadow);border-radius:var(--border-radius-large);overflow:hidden;padding:0;margin-bottom:-3px;margin-left:10px;visibility:hidden;opacity:0;transform:translateX(-50%);transition:opacity 0.2s, visibility 0.2s;height:44px}.menububble.is-active[data-v-7a686b54]{opacity:1;visibility:visible}.menububble__button[data-v-7a686b54]{display:block;flex-grow:1;border:0;padding:0.9rem 0.7rem;margin:0;border-radius:0;cursor:pointer;background-color:var(--color-main-background);border-right:1px solid var(--color-border)}.menububble__button[data-v-7a686b54]:focus,.menububble__button[data-v-7a686b54]:hover{background-color:var(--color-background-hover);border:0;border-right:1px solid var(--color-border) !important}.menububble__button[data-v-7a686b54]:last-child{border:0 !important}.menububble__buttontext[data-v-7a686b54]{padding:0.4rem;padding-right:0}.menububble__form[data-v-7a686b54]{display:flex;align-items:center}.menububble__input[data-v-7a686b54]{font:inherit;border:none;background:transparent;min-width:150px}\n","",{version:3,sources:["webpack://./src/components/MenuBubble.vue"],names:[],mappings:"AA+IA,6BACC,iBAAkB,CAClB,YAAa,CACb,aAAc,CACd,mDAAoD,CACpD,4CAA6C,CAC7C,wCAAyC,CACzC,eAAgB,CAChB,SAAU,CACV,kBAAmB,CACnB,gBAAiB,CACjB,iBAAkB,CAClB,SAAU,CACV,0BAA2B,CAC3B,wCAAyC,CACzC,WAAY,CAfb,uCAkBE,SAAU,CACV,kBAAmB,CACnB,qCAGA,aAAc,CACd,WAAY,CACZ,QAAS,CACT,qBAAsB,CACtB,QAAS,CACT,eAAgB,CAChB,cAAe,CACf,6CAA8C,CAC9C,0CAA2C,CAT3C,sFAaC,8CAA+C,CAC/C,QAAS,CACT,qDAAsD,CAfvD,gDAmBC,mBAAoB,CACpB,yCAID,cAAe,CACf,eAAgB,CAChB,mCAGA,YAAa,CACb,kBAAmB,CACnB,oCAGA,YAAa,CACb,WAAY,CACZ,sBAAuB,CACvB,eAAgB",sourcesContent:["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.menububble {\n\tposition: absolute;\n\tdisplay: flex;\n\tz-index: 10020;\n\tbackground: var(--color-main-background-translucent);\n\tbox-shadow: 0 1px 5px var(--color-box-shadow);\n\tborder-radius: var(--border-radius-large);\n\toverflow: hidden;\n\tpadding: 0;\n\tmargin-bottom: -3px;\n\tmargin-left: 10px;\n\tvisibility: hidden;\n\topacity: 0;\n\ttransform: translateX(-50%);\n\ttransition: opacity 0.2s, visibility 0.2s;\n\theight: 44px;\n\n\t&.is-active {\n\t\topacity: 1;\n\t\tvisibility: visible;\n\t}\n\n\t&__button {\n\t\tdisplay: block;\n\t\tflex-grow: 1;\n\t\tborder: 0;\n\t\tpadding: 0.9rem 0.7rem;\n\t\tmargin: 0;\n\t\tborder-radius: 0;\n\t\tcursor: pointer;\n\t\tbackground-color: var(--color-main-background);\n\t\tborder-right: 1px solid var(--color-border);\n\n\t\t&:focus,\n\t\t&:hover {\n\t\t\tbackground-color: var(--color-background-hover);\n\t\t\tborder: 0;\n\t\t\tborder-right: 1px solid var(--color-border) !important;\n\t\t}\n\n\t\t&:last-child {\n\t\t\tborder: 0 !important;\n\t\t}\n\t}\n\n\t&__buttontext {\n\t\tpadding: 0.4rem;\n\t\tpadding-right: 0;\n\t}\n\n\t&__form {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\n\t&__input {\n\t\tfont: inherit;\n\t\tborder: none;\n\t\tbackground: transparent;\n\t\tmin-width: 150px;\n\t}\n}\n"],sourceRoot:""}]),t.a=r},891:function(n,t,e){"use strict";e.d(t,"a",(function(){return i})),e.d(t,"b",(function(){return o}));var i=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("EditorMenuBar",{attrs:{editor:n.editor},scopedSlots:n._u([{key:"default",fn:function(t){var i=t.commands,o=t.isActive,a=t.focused;return[e("div",{staticClass:"menubar",class:{"is-focused":a,autohide:n.autohide}},[n.isRichEditor?e("div",{ref:"menubar",staticClass:"menubar-icons"},[n._l(n.allIcons,(function(t,a){return[t.class?e("button",{directives:[{name:"show",rawName:"v-show",value:a<n.iconCount,expression:"$index < iconCount"}],key:t.label,class:n.getIconClasses(o,t),attrs:{title:t.label,disabled:n.disabled(i,t)},on:{click:function(e){return n.clickIcon(i,t)}}}):[e("div",{directives:[{name:"show",rawName:"v-show",value:a<n.iconCount||!t.class,expression:"$index < iconCount || !icon.class"},{name:"click-outside",rawName:"v-click-outside",value:function(){return n.hideChildMenu(t)},expression:"() => hideChildMenu(icon)"}],key:t.label,staticClass:"submenu"},[e("button",{class:n.childIconClasses(o,t.children),attrs:{title:t.label},on:{click:function(e){return e.preventDefault(),n.toggleChildMenu(t)}}}),n._v(" "),e("div",{staticClass:"popovermenu menu-center",class:{open:n.isChildMenuVisible(t)}},[e("PopoverMenu",{attrs:{menu:n.childPopoverMenu(o,i,t.children,t)}})],1)])]]})),n._v(" "),e("Actions",[n._l(n.allIcons,(function(t,o){return[t.class&&n.isHiddenInMenu(o)?e("ActionButton",{key:t.class,attrs:{icon:t.class},on:{click:function(e){return n.clickIcon(i,t)}}},[n._v("\n\t\t\t\t\t\t"+n._s(t.label)+"\n\t\t\t\t\t")]):n._e()]}))],2)],2):n._e(),n._v(" "),n._t("default",[n._v("\n\t\t\tLeft side\n\t\t")])],2)]}}],null,!0)})},o=[]},892:function(n,t,e){"use strict";var i=e(19),o=e.n(i),a=e(836),r={insert:"head",singleton:!1};o()(a.a,r),a.a.locals},893:function(n,t,e){"use strict";e.d(t,"a",(function(){return i})),e.d(t,"b",(function(){return o}));var i=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("EditorMenuBubble",{staticClass:"menububble",attrs:{editor:n.editor},on:{hide:n.hideLinkMenu},scopedSlots:n._u([{key:"default",fn:function(t){var i=t.commands,o=t.isActive,a=t.getMarkAttrs,r=t.menu;return[e("div",{staticClass:"menububble",class:{"is-active":r.isActive},style:"left: "+r.left+"px; bottom: "+r.bottom+"px;"},[n.linkMenuIsActive?e("form",{staticClass:"menububble__form",on:{submit:function(t){return t.preventDefault(),n.setLinkUrl(i.link,n.linkUrl)}}},[e("input",{directives:[{name:"model",rawName:"v-model",value:n.linkUrl,expression:"linkUrl"}],ref:"linkInput",staticClass:"menububble__input",attrs:{type:"text",placeholder:"https://"},domProps:{value:n.linkUrl},on:{keydown:function(t){return!t.type.indexOf("key")&&n._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:n.hideLinkMenu(t)},input:function(t){t.target.composing||(n.linkUrl=t.target.value)}}}),n._v(" "),e("button",{staticClass:"menububble__button icon-confirm",attrs:{type:"button",tabindex:"0"},on:{click:function(t){return n.setLinkUrl(i.link,n.linkUrl)}}})]):[e("button",{staticClass:"menububble__button",class:{"is-active":o.link()},on:{click:function(t){n.showLinkMenu(a("link"))}}},[e("span",{staticClass:"icon-link"}),n._v(" "),e("span",{staticClass:"menububble__buttontext"},[n._v("\n\t\t\t\t\t"+n._s(n.t("text",o.link()?"Update Link":"Add Link"))+"\n\t\t\t\t")])]),n._v(" "),e("button",{staticClass:"menububble__button",class:{"is-active":o.link()},on:{click:function(t){return n.selectFile(i.link)}}},[e("span",{staticClass:"icon-file"}),n._v(" "),e("span",{staticClass:"menububble__buttontext"},[n._v(n._s(n.t("text","Link file")))])])]],2)]}}])})},o=[]},894:function(n,t,e){"use strict";var i=e(19),o=e.n(i),a=e(838),r={insert:"head",singleton:!1};o()(a.a,r),a.a.locals}}]);
//# sourceMappingURL=editor-rich.js.map?v=e1a0062588d549424916