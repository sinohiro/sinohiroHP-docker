{"version":3,"sources":["webpack:///./src/helpers/files.js","webpack:///./src/views/RichWorkspace.vue","webpack:///./src/views/RichWorkspace.vue?2e12","webpack:///./src/views/RichWorkspace.vue?d0bc","webpack:///src/views/RichWorkspace.vue","webpack:///./src/components/MenuBar.vue?c014","webpack:///src/components/MenuBar.vue","webpack:///./src/components/MenuBubble.vue?7a05","webpack:///src/components/MenuBubble.vue","webpack:///./src/views/RichWorkspace.vue?5070","webpack:///./src/views/RichWorkspace.vue?93d1","webpack:///./src/helpers/mime.js","webpack:///./src/components/MenuBar.vue","webpack:///./src/mixins/menubar.js","webpack:///./src/components/MenuBar.vue?b1d4","webpack:///./src/components/MenuBubble.vue","webpack:///./src/components/MenuBubble.vue?be8a","webpack:///./src/components/MenuBar.vue?e0c2","webpack:///./src/components/MenuBar.vue?9320","webpack:///./src/components/MenuBubble.vue?c2da","webpack:///./src/components/MenuBubble.vue?7647"],"names":["from","to","current","split","target","pop","shift","relativePath","fill","concat","absolutePath","length","join","newFileMenuPlugin","attach","menu","fileList","id","addMenuEntry","displayName","t","templateName","iconClass","fileType","actionHandler","name","createFile","then","status","data","fileInfoModel","OCA","Files","FileInfoModel","Viewer","fileActions","triggerAction","OC","Plugins","register","sharingToken","document","getElementById","value","dir","ViewerRoot","createElement","body","appendChild","registerAction","mime","PERMISSION_UPDATE","PERMISSION_READ","imagePath","filename","file","window","FileList","findFile","Promise","all","imports","path","getCurrentDirectory","Vue","default","prototype","n","Editor","render","h","props","fileId","active","shareToken","mimeType","mimetype","$mount","i","openMimetypes","setDefault","FilesWorkspacePlugin","el","this","registerHeader","bind","priority","module","vm","extend","RichWorkspace","propsData","store","$el","on","toString","component","options","locals","IS_PUBLIC","WORKSPACE_URL","___CSS_LOADER_EXPORT___","push","_vm","_h","$createElement","_c","_self","class","loaded","ready","focus","darkTheme","canCreate","attrs","staticClass","createNew","_v","_s","_e","directives","rawName","expression","key","autofocus","$event","unfocus","reset","staticRenderFns","openMimetypesMarkdown","openMimetypesPlainText","label","isActive","isDisabled","command","undoDepth","action","undo","redoDepth","redo","strong","em","strike","visible","children","heading","level","bullet_list","bullet_list_item","ordered_list","todo_item","blockquote","code_block","editor","scopedSlots","_u","fn","ref","commands","focused","autohide","_l","icon","$index","iconCount","getIconClasses","disabled","clickIcon","hideChildMenu","childIconClasses","preventDefault","toggleChildMenu","open","isChildMenuVisible","childPopoverMenu","isHiddenInMenu","_t","hideLinkMenu","getMarkAttrs","style","setLinkUrl","link","linkUrl","domProps","type","indexOf","_k","keyCode","composing","showLinkMenu","selectFile"],"mappings":"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A,MAIa,UAAAA,E,uEChBXC,EAAU,CAEd,OAAiB,OACjB,WAAoB,GAEP,IAAI,IAASA,GAIX,IAAQC,Q,gCCZvB,wHAA6L,YAAG,G,kGCgDhM,I,EAAA,G,EAAA,Q,2BACA,QACA,QAEA,MAAMC,IAAc,SAApB,2BACMC,GAAgB,EAAtB,8D,MAEA,CACA,qBACA,YACA,oFAEA,OACA,MACA,YACA,cAGA,UACA,CACA,SACA,YACA,UACA,UACA,SACA,aACA,8DACA,wCAGA,UACA,eACA,2FAEA,YACA,qEAEA,qBACA,kEAGA,OACA,OACA,oBAEA,SACA,GACA,kDAIA,gBACA,cACA,oBAEA,8CACA,gBACA,sBAEA,8CACA,mBAGA,SACA,YAGA,QACA,eACA,cACA,oBACA,iBACA,sBAGA,cACA,eACA,kBACA,cACA,yBAIA,OAHA,IACA,8BAEA,qCACA,wBAKA,OAJA,2BACA,iBACA,gBACA,gBACA,IACA,UACA,qDACA,4CAEA,iBAEA,eACA,eACA,cACA,kBACA,KAGA,YACA,gBAGA,iBACA,4BACA,kBACA,GACA,8EACA,2B,8CChKA,yHAAuL,YAAG,G,mGC2E1L,aACA,YACA,YACA,SAEA,YACA,YACA,YACA,YACA,Q,yDAEA,CACA,eACA,YACA,8BACA,uBACA,sBACA,mBAEA,YACA,kBACA,wBAEA,OACA,QACA,YACA,YACA,cAEA,cACA,aACA,YAEA,UACA,aACA,YAEA,UACA,aACA,YAEA,UACA,YACA,YACA,aAGA,UACA,CACA,cACA,eACA,iBACA,qBACA,mBACA,uBAGA,UACA,iBACA,+BAEA,mBACA,QACA,SACA,0DAGA,OADA,cACA,GAGA,aACA,QACA,EAKA,qBACA,YACA,uGAGA,WACA,qBACA,WAEA,gBACA,+BACA,mBACA,gBAEA,WACA,kCAIA,mBACA,kBACA,WACA,iBACA,QACA,gBACA,gBACA,YACA,eACA,uBAEA,0BAGA,WAGA,mBACA,cACA,4BACA,kCAGA,cACA,QACA,kBACA,aACA,iBACA,SAGA,aAGA,YACA,oBACA,iBACA,kGAEA,OADA,gCAGA,YACA,2BACA,iDA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","file":"editor-rich.js?v=e1a0062588d549424916","sourcesContent":["/*\n * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>\n *\n * @author Julius Härtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport { openMimetypes } from './mime'\nimport RichWorkspace from '../views/RichWorkspace'\nimport { imagePath } from '@nextcloud/router'\nimport store from '../store'\n\nconst FILE_ACTION_IDENTIFIER = 'Edit with text app'\n\nconst optimalPath = function(from, to) {\n\tconst current = from.split('/')\n\tconst target = to.split('/')\n\tcurrent.pop() // ignore filename\n\twhile (current[0] === target[0]) {\n\t\tcurrent.shift()\n\t\ttarget.shift()\n\t}\n\tconst relativePath = current.fill('..').concat(target)\n\tconst absolutePath = to.split('/')\n\treturn relativePath.length < absolutePath.length\n\t\t? relativePath.join('/')\n\t\t: to\n}\n\nconst registerFileCreate = () => {\n\tconst newFileMenuPlugin = {\n\t\tattach(menu) {\n\t\t\tconst fileList = menu.fileList\n\n\t\t\t// only attach to main file list, public view is not supported yet\n\t\t\tif (fileList.id !== 'files' && fileList.id !== 'files.public') {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// register the new menu entry\n\t\t\tmenu.addMenuEntry({\n\t\t\t\tid: 'file',\n\t\t\t\tdisplayName: t('text', 'New text document'),\n\t\t\t\ttemplateName: t('text', 'New text document') + '.md',\n\t\t\t\ticonClass: 'icon-filetype-text',\n\t\t\t\tfileType: 'file',\n\t\t\t\tactionHandler(name) {\n\t\t\t\t\tfileList.createFile(name).then(function(status, data) {\n\t\t\t\t\t\tconst fileInfoModel = new OCA.Files.FileInfoModel(data)\n\t\t\t\t\t\tif (typeof OCA.Viewer !== 'undefined') {\n\t\t\t\t\t\t\tOCA.Files.fileActions.triggerAction('view', fileInfoModel, fileList)\n\t\t\t\t\t\t} else if (typeof OCA.Viewer === 'undefined') {\n\t\t\t\t\t\t\tOCA.Files.fileActions.triggerAction(FILE_ACTION_IDENTIFIER, fileInfoModel, fileList)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t})\n\t\t},\n\t}\n\tOC.Plugins.register('OCA.Files.NewFileMenu', newFileMenuPlugin)\n}\n\nconst registerFileActionFallback = () => {\n\tconst sharingToken = document.getElementById('sharingToken') ? document.getElementById('sharingToken').value : null\n\tconst dir = document.getElementById('dir').value\n\n\tif (!sharingToken || dir !== '') {\n\t\tconst ViewerRoot = document.createElement('div')\n\t\tViewerRoot.id = 'text-viewer-fallback'\n\t\tdocument.body.appendChild(ViewerRoot)\n\t\tconst registerAction = (mime) => OCA.Files.fileActions.register(\n\t\t\tmime,\n\t\t\tFILE_ACTION_IDENTIFIER,\n\t\t\tOC.PERMISSION_UPDATE | OC.PERMISSION_READ,\n\t\t\timagePath('core', 'actions/rename'),\n\t\t\t(filename) => {\n\t\t\t\tconst file = window.FileList.findFile(filename)\n\t\t\t\tPromise.all([\n\t\t\t\t\timport('vue'),\n\t\t\t\t\timport(/* webpackChunkName: \"files-modal\" */'./../components/PublicFilesEditor'),\n\t\t\t\t]).then((imports) => {\n\t\t\t\t\tconst path = window.FileList.getCurrentDirectory() + '/' + filename\n\t\t\t\t\tconst Vue = imports[0].default\n\t\t\t\t\tVue.prototype.t = window.t\n\t\t\t\t\tVue.prototype.n = window.n\n\t\t\t\t\tVue.prototype.OCA = window.OCA\n\t\t\t\t\tconst Editor = imports[1].default\n\t\t\t\t\tconst vm = new Vue({\n\t\t\t\t\t\trender: h => h(Editor, {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tfileId: file ? file.id : null,\n\t\t\t\t\t\t\t\tactive: true,\n\t\t\t\t\t\t\t\tshareToken: sharingToken,\n\t\t\t\t\t\t\t\trelativePath: path,\n\t\t\t\t\t\t\t\tmimeType: file.mimetype,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}),\n\t\t\t\t\t})\n\t\t\t\t\tvm.$mount(ViewerRoot)\n\t\t\t\t})\n\t\t\t},\n\t\t\tt('text', 'Edit')\n\t\t)\n\n\t\tfor (let i = 0; i < openMimetypes.length; i++) {\n\t\t\tregisterAction(openMimetypes[i])\n\t\t\tOCA.Files.fileActions.setDefault(openMimetypes[i], FILE_ACTION_IDENTIFIER)\n\t\t}\n\t}\n\n}\n\nconst FilesWorkspacePlugin = {\n\n\tel: null,\n\n\tattach(fileList) {\n\t\tif (fileList.id !== 'files' && fileList.id !== 'files.public') {\n\t\t\treturn\n\t\t}\n\n\t\tthis.el = document.createElement('div')\n\t\tfileList.registerHeader({\n\t\t\tid: 'workspace',\n\t\t\tel: this.el,\n\t\t\trender: this.render.bind(this),\n\t\t\tpriority: 10,\n\t\t})\n\t},\n\n\trender(fileList) {\n\t\tif (fileList.id !== 'files' && fileList.id !== 'files.public') {\n\t\t\treturn\n\t\t}\n\n\t\timport('vue').then((module) => {\n\t\t\tconst Vue = module.default\n\t\t\tthis.el.id = 'files-workspace-wrapper'\n\t\t\tVue.prototype.t = window.t\n\t\t\tVue.prototype.n = window.n\n\t\t\tVue.prototype.OCA = window.OCA\n\t\t\tconst View = Vue.extend(RichWorkspace)\n\t\t\tconst vm = new View({\n\t\t\t\tpropsData: {\n\t\t\t\t\tpath: fileList.getCurrentDirectory(),\n\t\t\t\t},\n\t\t\t\tstore,\n\t\t\t}).$mount(this.el)\n\n\t\t\tfileList.$el.on('urlChanged', data => {\n\t\t\t\tvm.path = data.dir.toString()\n\t\t\t})\n\t\t\tfileList.$el.on('changeDirectory', data => {\n\t\t\t\tvm.path = data.dir.toString()\n\t\t\t})\n\t\t})\n\t},\n}\n\nexport {\n\toptimalPath,\n\tregisterFileActionFallback,\n\tregisterFileCreate,\n\tFilesWorkspacePlugin,\n\tFILE_ACTION_IDENTIFIER,\n}\n","import { render, staticRenderFns } from \"./RichWorkspace.vue?vue&type=template&id=374052d2&scoped=true&\"\nimport script from \"./RichWorkspace.vue?vue&type=script&lang=js&\"\nexport * from \"./RichWorkspace.vue?vue&type=script&lang=js&\"\nimport style0 from \"./RichWorkspace.vue?vue&type=style&index=0&id=374052d2&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"374052d2\",\n  null\n  \n)\n\nexport default component.exports","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RichWorkspace.vue?vue&type=style&index=0&id=374052d2&lang=scss&scoped=true&\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RichWorkspace.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RichWorkspace.vue?vue&type=script&lang=js&\"","<!--\n  - @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>\n  -\n  - @author Julius Härtl <jus@bitgrid.net>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<div v-if=\"enabled\" id=\"rich-workspace\" :class=\"{'icon-loading': !loaded || !ready, 'focus': focus, 'dark': darkTheme, 'creatable': canCreate}\">\n\t\t<div v-if=\"showEmptyWorkspace\" class=\"empty-workspace\" @click=\"createNew\">\n\t\t\t<p class=\"placeholder\">\n\t\t\t\t{{ t('text', 'Add notes, lists or links …') }}\n\t\t\t</p>\n\t\t</div>\n\n\t\t<EditorWrapper v-if=\"file\"\n\t\t\tv-show=\"ready\"\n\t\t\t:key=\"file.id\"\n\t\t\t:file-id=\"file.id\"\n\t\t\t:relative-path=\"file.path\"\n\t\t\t:share-token=\"shareToken\"\n\t\t\t:active=\"true\"\n\t\t\t:autohide=\"true\"\n\t\t\t:mime=\"file.mimetype\"\n\t\t\t:autofocus=\"autofocus\"\n\t\t\t@ready=\"ready=true\"\n\t\t\t@focus=\"focus=true\"\n\t\t\t@blur=\"unfocus\"\n\t\t\t@error=\"reset\" />\n\t</div>\n</template>\n\n<script>\nimport axios from '@nextcloud/axios'\nimport { generateOcsUrl } from '@nextcloud/router'\nimport { subscribe } from '@nextcloud/event-bus'\n\nconst IS_PUBLIC = !!(document.getElementById('isPublic'))\nconst WORKSPACE_URL = generateOcsUrl('apps/text' + (IS_PUBLIC ? '/public' : ''), 2) + 'workspace'\n\nexport default {\n\tname: 'RichWorkspace',\n\tcomponents: {\n\t\tEditorWrapper: () => import(/* webpackChunkName: \"editor\" */'./../components/EditorWrapper'),\n\t},\n\tprops: {\n\t\tpath: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tfocus: false,\n\t\t\tfolder: null,\n\t\t\tfile: null,\n\t\t\tloaded: false,\n\t\t\tready: false,\n\t\t\tautofocus: false,\n\t\t\tdarkTheme: OCA.Accessibility && OCA.Accessibility.theme === 'dark',\n\t\t\tenabled: OCA.Text.RichWorkspaceEnabled,\n\t\t}\n\t},\n\tcomputed: {\n\t\tshareToken() {\n\t\t\treturn document.getElementById('sharingToken') ? document.getElementById('sharingToken').value : null\n\t\t},\n\t\tcanCreate() {\n\t\t\treturn !!(this.folder && (this.folder.permissions & OC.PERMISSION_CREATE))\n\t\t},\n\t\tshowEmptyWorkspace() {\n\t\t\treturn (!this.file || (this.autofocus && !this.ready)) && this.canCreate\n\t\t},\n\t},\n\twatch: {\n\t\tpath() {\n\t\t\tthis.getFileInfo()\n\t\t},\n\t\tfocus(newValue) {\n\t\t\tif (!newValue) {\n\t\t\t\tdocument.querySelector('#editor').scrollTo(0, 0)\n\t\t\t}\n\t\t},\n\t},\n\tasync mounted() {\n\t\tif (this.enabled) {\n\t\t\tthis.getFileInfo()\n\t\t}\n\t\tsubscribe('Text::showRichWorkspace', () => {\n\t\t\tthis.enabled = true\n\t\t\tthis.getFileInfo()\n\t\t})\n\t\tsubscribe('Text::hideRichWorkspace', () => {\n\t\t\tthis.enabled = false\n\t\t})\n\t},\n\tmethods: {\n\t\tunfocus() {\n\t\t\t// setTimeout(() => this.focus = false, 2000)\n\t\t},\n\t\treset() {\n\t\t\tthis.file = null\n\t\t\tthis.focus = false\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.creating = false\n\t\t\t\tthis.getFileInfo()\n\t\t\t})\n\t\t},\n\t\tgetFileInfo() {\n\t\t\tthis.loaded = false\n\t\t\tthis.autofocus = false\n\t\t\tthis.ready = false\n\t\t\tconst params = { path: this.path }\n\t\t\tif (IS_PUBLIC) {\n\t\t\t\tparams.shareToken = this.shareToken\n\t\t\t}\n\t\t\treturn axios.get(WORKSPACE_URL, { params }).then((response) => {\n\t\t\t\tconst data = response.data.ocs.data\n\t\t\t\tthis.folder = data.folder || null\n\t\t\t\tthis.file = data.file\n\t\t\t\tthis.editing = true\n\t\t\t\tthis.loaded = true\n\t\t\t\treturn true\n\t\t\t}).catch((error) => {\n\t\t\t\tif (error.response.data.ocs && error.response.data.ocs.data.folder) {\n\t\t\t\t\tthis.folder = error.response.data.ocs.data.folder\n\t\t\t\t} else {\n\t\t\t\t\tthis.folder = null\n\t\t\t\t}\n\t\t\t\tthis.file = null\n\t\t\t\tthis.loaded = true\n\t\t\t\tthis.ready = true\n\t\t\t\tthis.creating = false\n\t\t\t\treturn false\n\t\t\t})\n\t\t},\n\t\tcreateNew() {\n\t\t\tif (this.creating) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tthis.creating = true\n\t\t\tthis.getFileInfo().then((workspaceFileExists) => {\n\t\t\t\tthis.autofocus = true\n\t\t\t\tif (!workspaceFileExists) {\n\t\t\t\t\twindow.FileList.createFile('Readme.md', { scrollTo: false, animate: false }).then((status, data) => {\n\t\t\t\t\t\tthis.getFileInfo()\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t},\n}\n</script>\n\n<style lang=\"scss\" scoped>\n\t#rich-workspace {\n\t\tpadding: 0 50px;\n\t\t/* Slightly reduce vertical space */\n\t\tmargin-bottom: -24px;\n\t\ttext-align: left;\n\t\tmax-height: 0;\n\t\ttransition: max-height 0.5s cubic-bezier(0, 1, 0, 1);\n\t\t&.creatable {\n\t\t\tmin-height: 90px;\n\t\t}\n\t}\n\n\t/* For subfolders, where there are no Recommendations */\n\t#rich-workspace:only-child {\n\t\tmargin-bottom: 0;\n\t}\n\n\t.empty-workspace {\n\t\tpadding-top: 43px;\n\t\tcolor: var(--color-text-maxcontrast);\n\t\theight: 0;\n\t}\n\n\t#rich-workspace::v-deep div[contenteditable=false] {\n\t\twidth: 100%;\n\t\tpadding: 0px;\n\t\tbackground-color: var(--color-main-background);\n\t\topacity: 1;\n\t\tborder: none;\n\t}\n\n\t#rich-workspace::v-deep #editor-container {\n\t\theight: 100%;\n\t\tposition: unset !important;\n\t\ttop: auto !important;\n\t}\n\n\t#rich-workspace::v-deep #editor-wrapper {\n\t\tposition: unset !important;\n\t\toverflow: visible;\n\t}\n\n\t#rich-workspace::v-deep #editor {\n\t\toverflow: scroll !important;\n\t\tmax-height: 50vh;\n\t\tpadding-left: 10px;\n\t}\n\n\t#rich-workspace::v-deep #editor-wrapper .ProseMirror {\n\t\tpadding: 0px;\n\t\tmargin: 0;\n\t}\n\n\t#rich-workspace::v-deep .menubar {\n\t\tz-index: 50;\n\t\t/* Slightly reduce vertical space */\n\t\tmargin-bottom: -10px;\n\t}\n\n\t#rich-workspace::v-deep .menubar .menubar-icons {\n\t\tmargin-left: 0;\n\t}\n\n\t#rich-workspace::v-deep .editor__content {\n\t\tmargin: 0;\n\t}\n\n\t#rich-workspace.focus {\n\t\tmax-height: 50vh;\n\t}\n\n\t#rich-workspace:not(.focus) {\n\t\tmax-height: 30vh;\n\t\tposition: relative;\n\t\toverflow: hidden;\n\t}\n\n\t#rich-workspace:not(.focus):not(.icon-loading):after {\n\t\tcontent: '';\n\t\tposition: absolute;\n\t\tz-index: 1;\n\t\tbottom: 0;\n\t\tleft: 0;\n\t\tpointer-events: none;\n\t\tbackground-image: linear-gradient(to bottom, rgba(255, 255, 255, 0), var(--color-main-background));\n\t\twidth: 100%;\n\t\theight: 4em;\n\t}\n\n\t#rich-workspace.dark:not(.focus):not(.icon-loading):after {\n\t\tbackground-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), var(--color-main-background));\n\t}\n\n\t@media only screen and (max-width: 1024px) {\n\t\t#rich-workspace:not(.focus) {\n\t\t\tmax-height: 30vh;\n\t\t}\n\t}\n\n\thtml.ie {\n\t\t#rich-workspace::v-deep {\n\t\t\t#editor-container {\n\t\t\t\tposition: initial;\n\t\t\t}\n\n\t\t\t#editor-wrapper {\n\t\t\t\tposition: relative !important;\n\t\t\t\ttop: auto !important;\n\t\t\t}\n\n\t\t\t#editor {\n\t\t\t\tdisplay: flex;\n\t\t\t\tflex-direction: column;\n\t\t\t\toverflow: hidden !important;\n\t\t\t}\n\n\t\t\t.menubar {\n\t\t\t\tposition: relative;\n\t\t\t\toverflow: hidden;\n\t\t\t\tflex-shrink: 0;\n\t\t\t\theight: 44px;\n\t\t\t\ttop: auto;\n\t\t\t}\n\n\t\t\t#editor > div:nth-child(2) {\n\t\t\t\tmin-height: 44px;\n\t\t\t\toverflow-x: hidden;\n\t\t\t\toverflow-y: auto;\n\t\t\t\tflex-shrink: 1;\n\t\t\t}\n\t\t}\n\t}\n\n</style>\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuBar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuBar.vue?vue&type=script&lang=js&\"","<!--\n  - @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>\n  -\n  - @author Julius Härtl <jus@bitgrid.net>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<EditorMenuBar v-slot=\"{ commands, isActive, focused }\" :editor=\"editor\">\n\t\t<div class=\"menubar\" :class=\"{ 'is-focused': focused, 'autohide': autohide }\">\n\t\t\t<div v-if=\"isRichEditor\" ref=\"menubar\" class=\"menubar-icons\">\n\t\t\t\t<template v-for=\"(icon, $index) in allIcons\">\n\t\t\t\t\t<button v-if=\"icon.class\"\n\t\t\t\t\t\tv-show=\"$index < iconCount\"\n\t\t\t\t\t\t:key=\"icon.label\"\n\t\t\t\t\t\t:title=\"icon.label\"\n\t\t\t\t\t\t:class=\"getIconClasses(isActive, icon)\"\n\t\t\t\t\t\t:disabled=\"disabled(commands, icon)\"\n\t\t\t\t\t\t@click=\"clickIcon(commands, icon)\" />\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div v-show=\"$index < iconCount || !icon.class\"\n\t\t\t\t\t\t\t:key=\"icon.label\"\n\t\t\t\t\t\t\tv-click-outside=\"() => hideChildMenu(icon)\"\n\t\t\t\t\t\t\tclass=\"submenu\">\n\t\t\t\t\t\t\t<button :class=\"childIconClasses(isActive, icon.children, )\"\n\t\t\t\t\t\t\t\t:title=\"icon.label\"\n\t\t\t\t\t\t\t\t@click.prevent=\"toggleChildMenu(icon)\" />\n\t\t\t\t\t\t\t<div :class=\"{open: isChildMenuVisible(icon)}\" class=\"popovermenu menu-center\">\n\t\t\t\t\t\t\t\t<PopoverMenu :menu=\"childPopoverMenu(isActive, commands, icon.children, icon)\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t\t<Actions>\n\t\t\t\t\t<template v-for=\"(icon, $index) in allIcons\">\n\t\t\t\t\t\t<ActionButton v-if=\"icon.class && isHiddenInMenu($index)\"\n\t\t\t\t\t\t\t:key=\"icon.class\"\n\t\t\t\t\t\t\t:icon=\"icon.class\"\n\t\t\t\t\t\t\t@click=\"clickIcon(commands, icon)\">\n\t\t\t\t\t\t\t{{ icon.label }}\n\t\t\t\t\t\t</ActionButton>\n\t\t\t\t\t\t<!--<template v-else-if=\"!icon.class && isHiddenInMenu($index)\">\n\t\t\t\t\t\t\t<ActionButton v-for=\"childIcon in icon.children\"\n\t\t\t\t\t\t\t\t:key=\"childIcon.class\"\n\t\t\t\t\t\t\t\t:icon=\"childIcon.class\"\n\t\t\t\t\t\t\t\t@click=\"clickIcon(commands, childIcon)\">\n\t\t\t\t\t\t\t\t{{ childIcon.label }}\n\t\t\t\t\t\t\t</ActionButton>\n\t\t\t\t\t\t</template>-->\n\t\t\t\t\t</template>\n\t\t\t\t</Actions>\n\t\t\t</div>\n\t\t\t<slot>\n\t\t\t\tLeft side\n\t\t\t</slot>\n\t\t</div>\n\t</EditorMenuBar>\n</template>\n\n<script>\nimport { EditorMenuBar } from 'tiptap'\nimport Tooltip from '@nextcloud/vue/dist/Directives/Tooltip'\nimport menuBarIcons from './../mixins/menubar'\nimport { optimalPath } from './../helpers/files'\n\nimport Actions from '@nextcloud/vue/dist/Components/Actions'\nimport ActionButton from '@nextcloud/vue/dist/Components/ActionButton'\nimport PopoverMenu from '@nextcloud/vue/dist/Components/PopoverMenu'\nimport ClickOutside from 'vue-click-outside'\nimport { getCurrentUser } from '@nextcloud/auth'\n\nexport default {\n\tname: 'MenuBar',\n\tcomponents: {\n\t\tEditorMenuBar,\n\t\tActionButton,\n\t\tPopoverMenu,\n\t\tActions,\n\t},\n\tdirectives: {\n\t\tTooltip,\n\t\tClickOutside,\n\t},\n\tprops: {\n\t\teditor: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tisRichEditor: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tautohide: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tisPublic: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tfilePath: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tdata: () => {\n\t\treturn {\n\t\t\twindowWidth: 0,\n\t\t\twindowHeight: 0,\n\t\t\tforceRecompute: 0,\n\t\t\tsubmenuVisibility: {},\n\t\t\tlastImagePath: null,\n\t\t\ticons: [...menuBarIcons],\n\t\t}\n\t},\n\tcomputed: {\n\t\tisHiddenInMenu() {\n\t\t\treturn ($index) => $index - this.iconCount >= 0\n\t\t},\n\t\tgetIconClasses() {\n\t\t\treturn (isActive, icon) => {\n\t\t\t\tconst classes = {\n\t\t\t\t\t'is-active': typeof icon.isActive === 'function' ? icon.isActive(isActive) : false,\n\t\t\t\t}\n\t\t\t\tclasses[icon.class] = true\n\t\t\t\treturn classes\n\t\t\t}\n\t\t},\n\t\tdisabled() {\n\t\t\treturn (commands, menuItem) => {\n\t\t\t\treturn false\n\t\t\t\t// FIXME with this we seem to be running into an endless rerender loop, so this needs more investigation at some later point\n\t\t\t\t// typeof menuItem.isDisabled === 'function' ? menuItem.isDisabled()(commands) : false\n\t\t\t}\n\t\t},\n\t\tisChildMenuVisible() {\n\t\t\treturn (icon) => {\n\t\t\t\treturn Object.prototype.hasOwnProperty.call(this.submenuVisibility, icon.label) ? this.submenuVisibility[icon.label] : false\n\t\t\t}\n\t\t},\n\t\tallIcons() {\n\t\t\tif (this.isPublic) {\n\t\t\t\treturn this.icons\n\t\t\t}\n\t\t\treturn [...this.icons, {\n\t\t\t\tlabel: t('text', 'Insert image'),\n\t\t\t\tclass: 'icon-image',\n\t\t\t\tisActive: () => {\n\t\t\t\t},\n\t\t\t\taction: (commands) => {\n\t\t\t\t\tthis.showImagePrompt(commands.image)\n\t\t\t\t},\n\t\t\t}]\n\t\t},\n\t\tchildPopoverMenu() {\n\t\t\treturn (isActive, commands, icons, parent) => {\n\t\t\t\tconst popoverMenuItems = []\n\t\t\t\tfor (const index in icons) {\n\t\t\t\t\tpopoverMenuItems.push({\n\t\t\t\t\t\ttext: icons[index].label,\n\t\t\t\t\t\ticon: icons[index].class,\n\t\t\t\t\t\taction: () => {\n\t\t\t\t\t\t\ticons[index].action(commands)\n\t\t\t\t\t\t\tthis.hideChildMenu(parent)\n\t\t\t\t\t\t},\n\t\t\t\t\t\tactive: icons[index].isActive(isActive),\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\treturn popoverMenuItems\n\t\t\t}\n\t\t},\n\t\tchildIconClasses() {\n\t\t\treturn (isActive, icons) => {\n\t\t\t\tconst icon = this.childIcon(isActive, icons)\n\t\t\t\treturn this.getIconClasses(isActive, icon)\n\t\t\t}\n\t\t},\n\t\tchildIcon() {\n\t\t\treturn (isActive, icons) => {\n\t\t\t\tfor (const index in icons) {\n\t\t\t\t\tconst icon = icons[index]\n\t\t\t\t\tif (icon.isActive(isActive)) {\n\t\t\t\t\t\treturn icon\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn icons[0]\n\t\t\t}\n\t\t},\n\t\ticonCount() {\n\t\t\tthis.forceRecompute // eslint-disable-line\n\t\t\tthis.windowWidth // eslint-disable-line\n\t\t\tconst menuBarWidth = this.$refs.menubar && this.$refs.menubar.clientWidth > 200 ? this.$refs.menubar.clientWidth : 200\n\t\t\tconst iconCount = Math.max((Math.floor(menuBarWidth / 44) - 2), 0)\n\t\t\treturn iconCount\n\t\t},\n\t\timagePath() {\n\t\t\treturn this.lastImagePath\n\t\t\t\t|| this.filePath.split('/').slice(0, -1).join('/')\n\t\t},\n\t},\n\tmounted() {\n\t\twindow.addEventListener('resize', this.getWindowWidth)\n\t\tthis.checkInterval = setInterval(() => {\n\t\t\tconst isWidthAvailable = (this.$refs.menubar && this.$refs.menubar.clientWidth > 0)\n\t\t\tif (this.isRichEditor && isWidthAvailable) {\n\t\t\t\tthis.redrawMenuBar()\n\t\t\t}\n\t\t\tif (!this.isRichEditor || isWidthAvailable) {\n\t\t\t\tclearInterval(this.checkInterval)\n\t\t\t}\n\t\t}, 100)\n\t},\n\tbeforeDestroy() {\n\t\twindow.removeEventListener('resize', this.getWindowWidth)\n\t},\n\tmethods: {\n\t\tredrawMenuBar() {\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.getWindowWidth()\n\t\t\t\tthis.forceRecompute++\n\t\t\t})\n\t\t},\n\t\tclickIcon(commands, icon) {\n\t\t\treturn icon.action(commands)\n\t\t},\n\t\tgetWindowWidth(event) {\n\t\t\tthis.windowWidth = document.documentElement.clientWidth\n\t\t},\n\t\tgetWindowHeight(event) {\n\t\t\tthis.windowHeight = document.documentElement.clientHeight\n\t\t},\n\t\thideChildMenu(icon) {\n\t\t\tthis.$set(this.submenuVisibility, icon.label, false)\n\t\t},\n\t\ttoggleChildMenu(icon) {\n\t\t\tconst lastValue = Object.prototype.hasOwnProperty.call(this.submenuVisibility, icon.label) ? this.submenuVisibility[icon.label] : false\n\t\t\tthis.$set(this.submenuVisibility, icon.label, !lastValue)\n\t\t},\n\t\tshowImagePrompt(command) {\n\t\t\tconst currentUser = getCurrentUser()\n\t\t\tif (!currentUser) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tconst _command = command\n\t\t\tOC.dialogs.filepicker(t('text', 'Insert an image'), (file) => {\n\t\t\t\tconst client = OC.Files.getClient()\n\t\t\t\tclient.getFileInfo(file).then((_status, fileInfo) => {\n\t\t\t\t\tthis.lastImagePath = fileInfo.path\n\n\t\t\t\t\t// dirty but works so we have the information stored in markdown\n\t\t\t\t\tconst appendMeta = {\n\t\t\t\t\t\tmimetype: fileInfo.mimetype,\n\t\t\t\t\t\thasPreview: fileInfo.hasPreview,\n\t\t\t\t\t}\n\t\t\t\t\tconst path = optimalPath(this.filePath, `${fileInfo.path}/${fileInfo.name}`)\n\t\t\t\t\tconst encodedPath = path.split('/').map(encodeURIComponent).join('/')\n\t\t\t\t\tconst meta = Object.entries(appendMeta).map(([key, val]) => `${key}=${encodeURIComponent(val)}`).join('&')\n\t\t\t\t\tconst src = `${encodedPath}?fileId=${fileInfo.id}#${meta}`\n\n\t\t\t\t\t_command({\n\t\t\t\t\t\tsrc,\n\t\t\t\t\t\talt: fileInfo.name,\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t}, false, [], true, undefined, this.imagePath)\n\t\t},\n\t\tshowLinkPrompt(command) {\n\t\t\tconst currentUser = OC.getCurrentUser()\n\t\t\tif (!currentUser) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tconst _command = command\n\t\t\tOC.dialogs.filepicker('Insert a link', (file) => {\n\t\t\t\tconst client = OC.Files.getClient()\n\t\t\t\tclient.getFileInfo(file).then((_status, fileInfo) => {\n\t\t\t\t\tthis.lastLinkPath = fileInfo.path\n\t\t\t\t\tconst path = this.optimalPathTo(`${fileInfo.path}/${fileInfo.name}`)\n\t\t\t\t\tconst encodedPath = path.split('/').map(encodeURIComponent).join('/')\n\t\t\t\t\tconst href = `${encodedPath}?fileId=${fileInfo.id}`\n\n\t\t\t\t\t_command({\n\t\t\t\t\t\thref,\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t}, false, [], true, undefined, this.linkPath)\n\t\t},\n\t\toptimalPathTo(targetFile) {\n\t\t\tconst absolutePath = targetFile.split('/')\n\t\t\tconst relativePath = this.relativePathTo(targetFile).split('/')\n\t\t\treturn relativePath.length < absolutePath.length\n\t\t\t\t? relativePath.join('/')\n\t\t\t\t: targetFile\n\t\t},\n\t\trelativePathTo(targetFile) {\n\t\t\tconst current = this.filePath.split('/')\n\t\t\tconst target = targetFile.split('/')\n\t\t\tcurrent.pop() // ignore filename\n\t\t\twhile (current[0] === target[0]) {\n\t\t\t\tcurrent.shift()\n\t\t\t\ttarget.shift()\n\t\t\t}\n\t\t\treturn current.fill('..').concat(target).join('/')\n\t\t},\n\t},\n}\n</script>\n\n<style scoped lang=\"scss\">\n\t.menubar {\n\t\t--background-blur: blur(10px);\n\t\tposition: fixed;\n\t\tposition: -webkit-sticky;\n\t\tposition: sticky;\n\t\ttop: 0;\n\t\tdisplay: flex;\n\t\tjustify-content: flex-end;\n\t\tz-index: 10021; // above modal-header and menububble so menubar is always on top\n\t\tbackground-color: var(--color-main-background-translucent);\n\t\t-webkit-backdrop-filter: var(--background-blur);\n\t\tbackdrop-filter: var(--background-blur);\n\t\tmin-height: 50px; // important for mobile so that the buttons are always inside the container\n\t\tpadding-top:3px;\n\t\tpadding-bottom: 3px;\n\n\t\t&.autohide {\n\t\t\tvisibility: hidden;\n\t\t\topacity: 0;\n\t\t\ttransition: visibility 0.2s 0.4s, opacity 0.2s 0.4s;\n\t\t\t&.is-focused {\n\t\t\t\tvisibility: visible;\n\t\t\t\topacity: 1;\n\t\t\t}\n\t\t}\n\t\t.menubar-icons {\n\t\t\tflex-grow: 1;\n\t\t\tmargin-left: calc((100% - 660px) / 2);\n\t\t}\n\t\t@media (max-width: 660px) {\n\t\t\t.menubar-icons {\n\t\t\t\tmargin-left: 0;\n\t\t\t}\n\t\t}\n\t\t&::v-deep .action-item__menu ul {\n\t\t\tmax-height: calc(100vh - 88px);\n\t\t\toverflow: scroll;\n\t\t}\n\t}\n\n\t.menubar button {\n\t\tposition: relative;\n\t\twidth: 44px;\n\t\theight: 44px;\n\t\tmargin: 0;\n\t\tbackground-size: 16px;\n\t\tborder: 0;\n\t\tbackground-color: transparent;\n\t\topacity: .5;\n\t\tcolor: var(--color-main-text);\n\t\tbackground-position: center center;\n\t\tvertical-align: top;\n\t\t&:hover, &:focus, &:active {\n\t\t\tbackground-color: var(--color-background-dark);\n\t\t}\n\n\t\t&.is-active::before {\n\t\t\ttransform: translateX(-50%);\n\t\t\tborder-radius: 100%;\n\t\t\tposition: absolute;\n\t\t\tbackground: var(--color-primary-element);\n\t\t\tbottom: 3px;\n\t\t\theight: 6px;\n\t\t\twidth: 6px;\n\t\t\tcontent: '';\n\t\t\tleft: 50%;\n\n\t\t}\n\t\t&.is-active,\n\t\t&:hover,\n\t\t&:focus {\n\t\t\topacity: 1;\n\t\t}\n\n\t\t&.icon-undo,\n\t\t&.icon-redo {\n\t\t\topacity: .8;\n\n\t\t\t&:disabled {\n\t\t\t\topacity: .4;\n\t\t\t}\n\t\t}\n\t}\n\n\t.menubar .submenu {\n\t\tdisplay: inline-block;\n\t\twidth: 44px;\n\t\theight: 44px;\n\t\tposition: relative;\n\t\tvertical-align: top;\n\t}\n</style>\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuBubble.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuBubble.vue?vue&type=script&lang=js&\"","<!--\n  - @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>\n  -\n  - @author Julius Härtl <jus@bitgrid.net>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<EditorMenuBubble v-slot=\"{ commands, isActive, getMarkAttrs, menu }\"\n\t\tclass=\"menububble\"\n\t\t:editor=\"editor\"\n\t\t@hide=\"hideLinkMenu\">\n\t\t<div class=\"menububble\" :class=\"{ 'is-active': menu.isActive }\" :style=\"`left: ${menu.left}px; bottom: ${menu.bottom}px;`\">\n\t\t\t<form v-if=\"linkMenuIsActive\" class=\"menububble__form\" @submit.prevent=\"setLinkUrl(commands.link, linkUrl)\">\n\t\t\t\t<input ref=\"linkInput\"\n\t\t\t\t\tv-model=\"linkUrl\"\n\t\t\t\t\tclass=\"menububble__input\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tplaceholder=\"https://\"\n\t\t\t\t\t@keydown.esc=\"hideLinkMenu\">\n\t\t\t\t<button class=\"menububble__button icon-confirm\"\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\ttabindex=\"0\"\n\t\t\t\t\t@click=\"setLinkUrl(commands.link, linkUrl)\" />\n\t\t\t</form>\n\n\t\t\t<template v-else>\n\t\t\t\t<button\n\t\t\t\t\tclass=\"menububble__button\"\n\t\t\t\t\t:class=\"{ 'is-active': isActive.link() }\"\n\t\t\t\t\t@click=\"showLinkMenu(getMarkAttrs('link'))\">\n\t\t\t\t\t<span class=\"icon-link\" />\n\t\t\t\t\t<span class=\"menububble__buttontext\">\n\t\t\t\t\t\t{{ t('text', isActive.link() ? 'Update Link' : 'Add Link') }}\n\t\t\t\t\t</span>\n\t\t\t\t</button>\n\t\t\t\t<button\n\t\t\t\t\tclass=\"menububble__button\"\n\t\t\t\t\t:class=\"{ 'is-active': isActive.link() }\"\n\t\t\t\t\t@click=\"selectFile(commands.link)\">\n\t\t\t\t\t<span class=\"icon-file\" />\n\t\t\t\t\t<span class=\"menububble__buttontext\">{{ t('text', 'Link file') }}</span>\n\t\t\t\t</button>\n\t\t\t</template>\n\t\t</div>\n\t</EditorMenuBubble>\n</template>\n\n<script>\nimport { EditorMenuBubble } from 'tiptap'\nimport Tooltip from '@nextcloud/vue/dist/Directives/Tooltip'\nimport { optimalPath } from './../helpers/files'\n\nexport default {\n\tname: 'MenuBubble',\n\tcomponents: {\n\t\tEditorMenuBubble,\n\t},\n\tdirectives: {\n\t\ttooltip: Tooltip,\n\t},\n\tprops: {\n\t\teditor: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tfilePath: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tdata: () => {\n\t\treturn {\n\t\t\tlinkUrl: null,\n\t\t\tlinkMenuIsActive: false,\n\t\t}\n\t},\n\tmethods: {\n\t\tshowLinkMenu(attrs) {\n\t\t\tthis.linkUrl = attrs.href\n\t\t\tthis.linkMenuIsActive = true\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.$refs.linkInput.focus()\n\t\t\t})\n\t\t},\n\t\thideLinkMenu() {\n\t\t\tthis.linkUrl = null\n\t\t\tthis.linkMenuIsActive = false\n\t\t},\n\t\tselectFile(command) {\n\t\t\tconst currentUser = OC.getCurrentUser()\n\t\t\tif (!currentUser) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tconst startPath = this.filePath.split('/').slice(0, -1).join('/')\n\t\t\tOC.dialogs.filepicker(t('text', 'Select file to link to'), (file) => {\n\t\t\t\tconst client = OC.Files.getClient()\n\t\t\t\tclient.getFileInfo(file).then((_status, fileInfo) => {\n\t\t\t\t\tconst path = optimalPath(this.filePath, `${fileInfo.path}/${fileInfo.name}`)\n\t\t\t\t\tconst encodedPath = path.split('/').map(encodeURIComponent).join('/')\n\t\t\t\t\tcommand({ href: `${encodedPath}?fileId=${fileInfo.id}` })\n\t\t\t\t\tthis.hideLinkMenu()\n\t\t\t\t})\n\t\t\t}, false, [], true, undefined, startPath)\n\t\t},\n\t\tsetLinkUrl(command, url) {\n\t\t\t// Heuristics for determining if we need a https:// prefix.\n\t\t\tconst noPrefixes = [\n\t\t\t\t/^[a-zA-Z]+:/, // url with protocol (\"mailTo:email@domain.tld\")\n\t\t\t\t/^\\//, // absolute path\n\t\t\t\t/\\?fileId=/, // relative link with fileId\n\t\t\t\t/^\\.\\.?\\//, // relative link starting with ./ or ../\n\t\t\t\t/^[^.]*[/$]/, // no dots before first '/' - not a domain name\n\t\t\t\t/^#/, // url fragment\n\t\t\t]\n\t\t\tif (url && !noPrefixes.find(regex => url.match(regex))) {\n\t\t\t\turl = 'https://' + url\n\t\t\t}\n\t\t\tcommand({ href: url })\n\t\t\tthis.hideLinkMenu()\n\t\t},\n\t},\n}\n</script>\n\n<style scoped lang=\"scss\">\n\t.menububble {\n\t\tposition: absolute;\n\t\tdisplay: flex;\n\t\tz-index: 10020;\n\t\tbackground: var(--color-main-background-translucent);\n\t\tbox-shadow: 0 1px 5px var(--color-box-shadow);\n\t\tborder-radius: var(--border-radius-large);\n\t\toverflow: hidden;\n\t\tpadding: 0;\n\t\tmargin-bottom: -3px;\n\t\tmargin-left: 10px;\n\t\tvisibility: hidden;\n\t\topacity: 0;\n\t\ttransform: translateX(-50%);\n\t\ttransition: opacity 0.2s, visibility 0.2s;\n\t\theight: 44px;\n\n\t\t&.is-active {\n\t\t\topacity: 1;\n\t\t\tvisibility: visible;\n\t\t}\n\n\t\t&__button {\n\t\t\tdisplay: block;\n\t\t\tflex-grow: 1;\n\t\t\tborder: 0;\n\t\t\tpadding: 0.9rem 0.7rem;\n\t\t\tmargin: 0;\n\t\t\tborder-radius: 0;\n\t\t\tcursor: pointer;\n\t\t\tbackground-color: var(--color-main-background);\n\t\t\tborder-right: 1px solid var(--color-border);\n\n\t\t\t&:focus,\n\t\t\t&:hover {\n\t\t\t\tbackground-color: var(--color-background-hover);\n\t\t\t\tborder: 0;\n\t\t\t\tborder-right: 1px solid var(--color-border) !important;\n\t\t\t}\n\n\t\t\t&:last-child {\n\t\t\t\tborder: 0 !important;\n\t\t\t}\n\t\t}\n\n\t\t&__buttontext {\n\t\t\tpadding: 0.4rem;\n\t\t\tpadding-right: 0;\n\t\t}\n\n\t\t&__form {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t}\n\n\t\t&__input {\n\t\t\tfont: inherit;\n\t\t\tborder: none;\n\t\t\tbackground: transparent;\n\t\t\tmin-width: 150px;\n\t\t}\n\t}\n</style>\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"#rich-workspace[data-v-374052d2]{padding:0 50px;margin-bottom:-24px;text-align:left;max-height:0;transition:max-height 0.5s cubic-bezier(0, 1, 0, 1)}#rich-workspace.creatable[data-v-374052d2]{min-height:90px}#rich-workspace[data-v-374052d2]:only-child{margin-bottom:0}.empty-workspace[data-v-374052d2]{padding-top:43px;color:var(--color-text-maxcontrast);height:0}#rich-workspace[data-v-374052d2] div[contenteditable=false]{width:100%;padding:0px;background-color:var(--color-main-background);opacity:1;border:none}#rich-workspace[data-v-374052d2] #editor-container{height:100%;position:unset !important;top:auto !important}#rich-workspace[data-v-374052d2] #editor-wrapper{position:unset !important;overflow:visible}#rich-workspace[data-v-374052d2] #editor{overflow:scroll !important;max-height:50vh;padding-left:10px}#rich-workspace[data-v-374052d2] #editor-wrapper .ProseMirror{padding:0px;margin:0}#rich-workspace[data-v-374052d2] .menubar{z-index:50;margin-bottom:-10px}#rich-workspace[data-v-374052d2] .menubar .menubar-icons{margin-left:0}#rich-workspace[data-v-374052d2] .editor__content{margin:0}#rich-workspace.focus[data-v-374052d2]{max-height:50vh}#rich-workspace[data-v-374052d2]:not(.focus){max-height:30vh;position:relative;overflow:hidden}#rich-workspace[data-v-374052d2]:not(.focus):not(.icon-loading):after{content:'';position:absolute;z-index:1;bottom:0;left:0;pointer-events:none;background-image:linear-gradient(to bottom, rgba(255,255,255,0), var(--color-main-background));width:100%;height:4em}#rich-workspace.dark[data-v-374052d2]:not(.focus):not(.icon-loading):after{background-image:linear-gradient(to bottom, rgba(0,0,0,0), var(--color-main-background))}@media only screen and (max-width: 1024px){#rich-workspace[data-v-374052d2]:not(.focus){max-height:30vh}}html.ie #rich-workspace[data-v-374052d2] #editor-container{position:initial}html.ie #rich-workspace[data-v-374052d2] #editor-wrapper{position:relative !important;top:auto !important}html.ie #rich-workspace[data-v-374052d2] #editor{display:flex;flex-direction:column;overflow:hidden !important}html.ie #rich-workspace[data-v-374052d2] .menubar{position:relative;overflow:hidden;flex-shrink:0;height:44px;top:auto}html.ie #rich-workspace[data-v-374052d2] #editor>div:nth-child(2){min-height:44px;overflow-x:hidden;overflow-y:auto;flex-shrink:1}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/views/RichWorkspace.vue\"],\"names\":[],\"mappings\":\"AA0KA,iCACC,cAAe,CAEf,mBAAoB,CACpB,eAAgB,CAChB,YAAa,CACb,mDAAoD,CANrD,2CAQE,eAAgB,CAChB,4CAKD,eAAgB,CAChB,kCAGA,gBAAiB,CACjB,mCAAoC,CACpC,QAAS,CACT,4DAGA,UAAW,CACX,WAAY,CACZ,6CAA8C,CAC9C,SAAU,CACV,WAAY,CACZ,mDAGA,WAAY,CACZ,yBAA0B,CAC1B,mBAAoB,CACpB,iDAGA,yBAA0B,CAC1B,gBAAiB,CACjB,yCAGA,0BAA2B,CAC3B,eAAgB,CAChB,iBAAkB,CAClB,8DAGA,WAAY,CACZ,QAAS,CACT,0CAGA,UAAW,CAEX,mBAAoB,CACpB,yDAGA,aAAc,CACd,kDAGA,QAAS,CACT,uCAGA,eAAgB,CAChB,6CAGA,eAAgB,CAChB,iBAAkB,CAClB,eAAgB,CAChB,sEAGA,UAAW,CACX,iBAAkB,CAClB,SAAU,CACV,QAAS,CACT,MAAO,CACP,mBAAoB,CACpB,8FAAkG,CAClG,UAAW,CACX,UAAW,CACX,2EAGA,wFAA4F,CAC5F,2CAGA,6CACC,eAAgB,CAChB,CAGF,2DAGG,gBAAiB,CAHpB,yDAOG,4BAA6B,CAC7B,mBAAoB,CARvB,iDAYG,YAAa,CACb,qBAAsB,CACtB,0BAA2B,CAd9B,kDAkBG,iBAAkB,CAClB,eAAgB,CAChB,aAAc,CACd,WAAY,CACZ,QAAS,CAtBZ,kEA0BG,eAAgB,CAChB,iBAAkB,CAClB,eAAgB,CAChB,aAAc\",\"sourcesContent\":[\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n#rich-workspace {\\n\\tpadding: 0 50px;\\n\\t/* Slightly reduce vertical space */\\n\\tmargin-bottom: -24px;\\n\\ttext-align: left;\\n\\tmax-height: 0;\\n\\ttransition: max-height 0.5s cubic-bezier(0, 1, 0, 1);\\n\\t&.creatable {\\n\\t\\tmin-height: 90px;\\n\\t}\\n}\\n\\n/* For subfolders, where there are no Recommendations */\\n#rich-workspace:only-child {\\n\\tmargin-bottom: 0;\\n}\\n\\n.empty-workspace {\\n\\tpadding-top: 43px;\\n\\tcolor: var(--color-text-maxcontrast);\\n\\theight: 0;\\n}\\n\\n#rich-workspace::v-deep div[contenteditable=false] {\\n\\twidth: 100%;\\n\\tpadding: 0px;\\n\\tbackground-color: var(--color-main-background);\\n\\topacity: 1;\\n\\tborder: none;\\n}\\n\\n#rich-workspace::v-deep #editor-container {\\n\\theight: 100%;\\n\\tposition: unset !important;\\n\\ttop: auto !important;\\n}\\n\\n#rich-workspace::v-deep #editor-wrapper {\\n\\tposition: unset !important;\\n\\toverflow: visible;\\n}\\n\\n#rich-workspace::v-deep #editor {\\n\\toverflow: scroll !important;\\n\\tmax-height: 50vh;\\n\\tpadding-left: 10px;\\n}\\n\\n#rich-workspace::v-deep #editor-wrapper .ProseMirror {\\n\\tpadding: 0px;\\n\\tmargin: 0;\\n}\\n\\n#rich-workspace::v-deep .menubar {\\n\\tz-index: 50;\\n\\t/* Slightly reduce vertical space */\\n\\tmargin-bottom: -10px;\\n}\\n\\n#rich-workspace::v-deep .menubar .menubar-icons {\\n\\tmargin-left: 0;\\n}\\n\\n#rich-workspace::v-deep .editor__content {\\n\\tmargin: 0;\\n}\\n\\n#rich-workspace.focus {\\n\\tmax-height: 50vh;\\n}\\n\\n#rich-workspace:not(.focus) {\\n\\tmax-height: 30vh;\\n\\tposition: relative;\\n\\toverflow: hidden;\\n}\\n\\n#rich-workspace:not(.focus):not(.icon-loading):after {\\n\\tcontent: '';\\n\\tposition: absolute;\\n\\tz-index: 1;\\n\\tbottom: 0;\\n\\tleft: 0;\\n\\tpointer-events: none;\\n\\tbackground-image: linear-gradient(to bottom, rgba(255, 255, 255, 0), var(--color-main-background));\\n\\twidth: 100%;\\n\\theight: 4em;\\n}\\n\\n#rich-workspace.dark:not(.focus):not(.icon-loading):after {\\n\\tbackground-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), var(--color-main-background));\\n}\\n\\n@media only screen and (max-width: 1024px) {\\n\\t#rich-workspace:not(.focus) {\\n\\t\\tmax-height: 30vh;\\n\\t}\\n}\\n\\nhtml.ie {\\n\\t#rich-workspace::v-deep {\\n\\t\\t#editor-container {\\n\\t\\t\\tposition: initial;\\n\\t\\t}\\n\\n\\t\\t#editor-wrapper {\\n\\t\\t\\tposition: relative !important;\\n\\t\\t\\ttop: auto !important;\\n\\t\\t}\\n\\n\\t\\t#editor {\\n\\t\\t\\tdisplay: flex;\\n\\t\\t\\tflex-direction: column;\\n\\t\\t\\toverflow: hidden !important;\\n\\t\\t}\\n\\n\\t\\t.menubar {\\n\\t\\t\\tposition: relative;\\n\\t\\t\\toverflow: hidden;\\n\\t\\t\\tflex-shrink: 0;\\n\\t\\t\\theight: 44px;\\n\\t\\t\\ttop: auto;\\n\\t\\t}\\n\\n\\t\\t#editor > div:nth-child(2) {\\n\\t\\t\\tmin-height: 44px;\\n\\t\\t\\toverflow-x: hidden;\\n\\t\\t\\toverflow-y: auto;\\n\\t\\t\\tflex-shrink: 1;\\n\\t\\t}\\n\\t}\\n}\\n\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.enabled)?_c('div',{class:{'icon-loading': !_vm.loaded || !_vm.ready, 'focus': _vm.focus, 'dark': _vm.darkTheme, 'creatable': _vm.canCreate},attrs:{\"id\":\"rich-workspace\"}},[(_vm.showEmptyWorkspace)?_c('div',{staticClass:\"empty-workspace\",on:{\"click\":_vm.createNew}},[_c('p',{staticClass:\"placeholder\"},[_vm._v(\"\\n\\t\\t\\t\"+_vm._s(_vm.t('text', 'Add notes, lists or links …'))+\"\\n\\t\\t\")])]):_vm._e(),_vm._v(\" \"),(_vm.file)?_c('EditorWrapper',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.ready),expression:\"ready\"}],key:_vm.file.id,attrs:{\"file-id\":_vm.file.id,\"relative-path\":_vm.file.path,\"share-token\":_vm.shareToken,\"active\":true,\"autohide\":true,\"mime\":_vm.file.mimetype,\"autofocus\":_vm.autofocus},on:{\"ready\":function($event){_vm.ready=true},\"focus\":function($event){_vm.focus=true},\"blur\":_vm.unfocus,\"error\":_vm.reset}}):_vm._e()],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/*\n * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>\n *\n * @author Julius Härtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nconst openMimetypesMarkdown = [\n\t'text/markdown',\n]\n\nconst openMimetypesPlainText = [\n\t'text/plain',\n\t'application/cmd',\n\t'application/x-empty',\n\t'application/x-msdos-program',\n\t'application/javascript',\n\t'application/json',\n\t'application/x-perl',\n\t'application/x-php',\n\t'application/x-tex',\n\t'application/xml',\n\t'application/yaml',\n\t'text/css',\n\t'text/csv',\n\t'text/html',\n\t'text/org',\n\t'text/x-c',\n\t'text/x-c++src',\n\t'text/x-h',\n\t'text/x-java-source',\n\t'text/x-ldif',\n\t'text/x-python',\n\t'text/x-shellscript',\n]\n\nconst openMimetypes = [...openMimetypesMarkdown, ...openMimetypesPlainText]\n\nexport {\n\topenMimetypes,\n\topenMimetypesMarkdown,\n\topenMimetypesPlainText,\n}\n","import { render, staticRenderFns } from \"./MenuBar.vue?vue&type=template&id=0f96f50e&scoped=true&\"\nimport script from \"./MenuBar.vue?vue&type=script&lang=js&\"\nexport * from \"./MenuBar.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MenuBar.vue?vue&type=style&index=0&id=0f96f50e&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0f96f50e\",\n  null\n  \n)\n\nexport default component.exports","/*\n * @copyright Copyright (c) 2019 Julius Härtl <jus@bitgrid.net>\n *\n * @author Julius Härtl <jus@bitgrid.net>\n *\n * @license GNU AGPL version 3 or any later version\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport default [\n\t{\n\t\tlabel: t('text', 'Undo'),\n\t\tclass: 'icon-undo',\n\t\tisActive: (isActive) => false,\n\t\tisDisabled: (command) => command.undoDepth() === 0,\n\t\taction: (command) => command.undo(),\n\t},\n\t{\n\t\tlabel: t('text', 'Redo'),\n\t\tclass: 'icon-redo',\n\t\tisActive: (isActive) => false,\n\t\tisDisabled: (command) => command.redoDepth() === 0,\n\t\taction: (command) => command.redo(),\n\t},\n\t{\n\t\tlabel: t('text', 'Bold'),\n\t\tclass: 'icon-bold',\n\t\tisActive: (isActive) => isActive.strong(),\n\t\taction: (command) => {\n\t\t\treturn command.strong()\n\t\t},\n\t},\n\t{\n\t\tlabel: t('text', 'Italic'),\n\t\tclass: 'icon-italic',\n\t\tisActive: (isActive) => isActive.em(),\n\t\taction: (command) => {\n\t\t\treturn command.em()\n\t\t},\n\t},\n\t{\n\t\tlabel: t('text', 'Strikethrough'),\n\t\tclass: 'icon-strike',\n\t\tisActive: (isActive) => isActive.strike(),\n\t\taction: (command) => {\n\t\t\treturn command.strike()\n\t\t},\n\t},\n\t{\n\t\tlabel: t('text', 'Headings'),\n\t\tvisible: false,\n\t\tchildren: [\n\t\t\t{\n\t\t\t\tlabel: t('text', 'Heading 1'),\n\t\t\t\tclass: 'icon-h1',\n\t\t\t\tisActive: (isActive) => isActive.heading({ level: 1 }),\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.heading({ level: 1 })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: t('text', 'Heading 2'),\n\t\t\t\tclass: 'icon-h2',\n\t\t\t\tisActive: (isActive) => isActive.heading({ level: 2 }),\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.heading({ level: 2 })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: t('text', 'Heading 3'),\n\t\t\t\tclass: 'icon-h3',\n\t\t\t\tisActive: (isActive) => isActive.heading({ level: 3 }),\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.heading({ level: 3 })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: t('text', 'Heading 4'),\n\t\t\t\tclass: 'icon-h4',\n\t\t\t\tisActive: (isActive) => isActive.heading({ level: 4 }),\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.heading({ level: 4 })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: t('text', 'Heading 5'),\n\t\t\t\tclass: 'icon-h5',\n\t\t\t\tisActive: (isActive) => isActive.heading({ level: 5 }),\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.heading({ level: 5 })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: t('text', 'Heading 6'),\n\t\t\t\tclass: 'icon-h6',\n\t\t\t\tisActive: (isActive) => isActive.heading({ level: 6 }),\n\t\t\t\taction: (command) => {\n\t\t\t\t\treturn command.heading({ level: 6 })\n\t\t\t\t},\n\t\t\t},\n\t\t],\n\t},\n\t{\n\t\tlabel: t('text', 'Unordered list'),\n\t\tclass: 'icon-ul',\n\t\tisActive: (isActive) => isActive.bullet_list(),\n\t\taction: (command) => {\n\t\t\treturn command.bullet_list_item()\n\t\t},\n\t},\n\t{\n\t\tlabel: t('text', 'Ordered list'),\n\t\tclass: 'icon-ol',\n\t\tisActive: (isActive) => isActive.ordered_list(),\n\t\taction: (command) => {\n\t\t\treturn command.ordered_list()\n\t\t},\n\t},\n\t{\n\t\tlabel: t('text', 'ToDo list'),\n\t\tclass: 'icon-checkmark',\n\t\tisActive: (isActive) => false,\n\t\taction: (command) => command.todo_item(),\n\t},\n\t{\n\t\tlabel: t('text', 'Blockquote'),\n\t\tclass: 'icon-quote',\n\t\tisActive: (isActive) => isActive.blockquote(),\n\t\taction: (command) => {\n\t\t\treturn command.blockquote()\n\t\t},\n\t},\n\t{\n\t\tlabel: t('text', 'Code block'),\n\t\tclass: 'icon-code',\n\t\tisActive: (isActive) => isActive.code_block(),\n\t\taction: (command) => {\n\t\t\treturn command.code_block()\n\t\t},\n\t},\n]\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".menubar[data-v-0f96f50e]{--background-blur: blur(10px);position:fixed;position:-webkit-sticky;position:sticky;top:0;display:flex;justify-content:flex-end;z-index:10021;background-color:var(--color-main-background-translucent);-webkit-backdrop-filter:var(--background-blur);backdrop-filter:var(--background-blur);min-height:50px;padding-top:3px;padding-bottom:3px}.menubar.autohide[data-v-0f96f50e]{visibility:hidden;opacity:0;transition:visibility 0.2s 0.4s, opacity 0.2s 0.4s}.menubar.autohide.is-focused[data-v-0f96f50e]{visibility:visible;opacity:1}.menubar .menubar-icons[data-v-0f96f50e]{flex-grow:1;margin-left:calc((100% - 660px) / 2)}@media (max-width: 660px){.menubar .menubar-icons[data-v-0f96f50e]{margin-left:0}}.menubar[data-v-0f96f50e] .action-item__menu ul{max-height:calc(100vh - 88px);overflow:scroll}.menubar button[data-v-0f96f50e]{position:relative;width:44px;height:44px;margin:0;background-size:16px;border:0;background-color:transparent;opacity:.5;color:var(--color-main-text);background-position:center center;vertical-align:top}.menubar button[data-v-0f96f50e]:hover,.menubar button[data-v-0f96f50e]:focus,.menubar button[data-v-0f96f50e]:active{background-color:var(--color-background-dark)}.menubar button.is-active[data-v-0f96f50e]::before{transform:translateX(-50%);border-radius:100%;position:absolute;background:var(--color-primary-element);bottom:3px;height:6px;width:6px;content:'';left:50%}.menubar button.is-active[data-v-0f96f50e],.menubar button[data-v-0f96f50e]:hover,.menubar button[data-v-0f96f50e]:focus{opacity:1}.menubar button.icon-undo[data-v-0f96f50e],.menubar button.icon-redo[data-v-0f96f50e]{opacity:.8}.menubar button.icon-undo[data-v-0f96f50e]:disabled,.menubar button.icon-redo[data-v-0f96f50e]:disabled{opacity:.4}.menubar .submenu[data-v-0f96f50e]{display:inline-block;width:44px;height:44px;position:relative;vertical-align:top}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/MenuBar.vue\"],\"names\":[],\"mappings\":\"AAqUA,0BACC,6BAAkB,CAClB,cAAe,CACf,uBAAwB,CACxB,eAAgB,CAChB,KAAM,CACN,YAAa,CACb,wBAAyB,CACzB,aAAc,CACd,yDAA0D,CAC1D,8CAA+C,CAC/C,sCAAuC,CACvC,eAAgB,CAChB,eAAe,CACf,kBAAmB,CAdpB,mCAiBE,iBAAkB,CAClB,SAAU,CACV,kDAAmD,CAnBrD,8CAqBG,kBAAmB,CACnB,SAAU,CAtBb,yCA0BE,WAAY,CACZ,oCAAqC,CACrC,0BA5BF,yCA+BG,aAAc,CACd,CAhCH,gDAmCE,6BAA8B,CAC9B,eAAgB,CAChB,iCAID,iBAAkB,CAClB,UAAW,CACX,WAAY,CACZ,QAAS,CACT,oBAAqB,CACrB,QAAS,CACT,4BAA6B,CAC7B,UAAW,CACX,4BAA6B,CAC7B,iCAAkC,CAClC,kBAAmB,CAXpB,sHAaE,6CAA8C,CAbhD,mDAiBE,0BAA2B,CAC3B,kBAAmB,CACnB,iBAAkB,CAClB,uCAAwC,CACxC,UAAW,CACX,UAAW,CACX,SAAU,CACV,UAAW,CACX,QAAS,CAzBX,yHA+BE,SAAU,CA/BZ,sFAoCE,UAAW,CApCb,wGAuCG,UAAW,CACX,mCAKF,oBAAqB,CACrB,UAAW,CACX,WAAY,CACZ,iBAAkB,CAClB,kBAAmB\",\"sourcesContent\":[\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n.menubar {\\n\\t--background-blur: blur(10px);\\n\\tposition: fixed;\\n\\tposition: -webkit-sticky;\\n\\tposition: sticky;\\n\\ttop: 0;\\n\\tdisplay: flex;\\n\\tjustify-content: flex-end;\\n\\tz-index: 10021; // above modal-header and menububble so menubar is always on top\\n\\tbackground-color: var(--color-main-background-translucent);\\n\\t-webkit-backdrop-filter: var(--background-blur);\\n\\tbackdrop-filter: var(--background-blur);\\n\\tmin-height: 50px; // important for mobile so that the buttons are always inside the container\\n\\tpadding-top:3px;\\n\\tpadding-bottom: 3px;\\n\\n\\t&.autohide {\\n\\t\\tvisibility: hidden;\\n\\t\\topacity: 0;\\n\\t\\ttransition: visibility 0.2s 0.4s, opacity 0.2s 0.4s;\\n\\t\\t&.is-focused {\\n\\t\\t\\tvisibility: visible;\\n\\t\\t\\topacity: 1;\\n\\t\\t}\\n\\t}\\n\\t.menubar-icons {\\n\\t\\tflex-grow: 1;\\n\\t\\tmargin-left: calc((100% - 660px) / 2);\\n\\t}\\n\\t@media (max-width: 660px) {\\n\\t\\t.menubar-icons {\\n\\t\\t\\tmargin-left: 0;\\n\\t\\t}\\n\\t}\\n\\t&::v-deep .action-item__menu ul {\\n\\t\\tmax-height: calc(100vh - 88px);\\n\\t\\toverflow: scroll;\\n\\t}\\n}\\n\\n.menubar button {\\n\\tposition: relative;\\n\\twidth: 44px;\\n\\theight: 44px;\\n\\tmargin: 0;\\n\\tbackground-size: 16px;\\n\\tborder: 0;\\n\\tbackground-color: transparent;\\n\\topacity: .5;\\n\\tcolor: var(--color-main-text);\\n\\tbackground-position: center center;\\n\\tvertical-align: top;\\n\\t&:hover, &:focus, &:active {\\n\\t\\tbackground-color: var(--color-background-dark);\\n\\t}\\n\\n\\t&.is-active::before {\\n\\t\\ttransform: translateX(-50%);\\n\\t\\tborder-radius: 100%;\\n\\t\\tposition: absolute;\\n\\t\\tbackground: var(--color-primary-element);\\n\\t\\tbottom: 3px;\\n\\t\\theight: 6px;\\n\\t\\twidth: 6px;\\n\\t\\tcontent: '';\\n\\t\\tleft: 50%;\\n\\n\\t}\\n\\t&.is-active,\\n\\t&:hover,\\n\\t&:focus {\\n\\t\\topacity: 1;\\n\\t}\\n\\n\\t&.icon-undo,\\n\\t&.icon-redo {\\n\\t\\topacity: .8;\\n\\n\\t\\t&:disabled {\\n\\t\\t\\topacity: .4;\\n\\t\\t}\\n\\t}\\n}\\n\\n.menubar .submenu {\\n\\tdisplay: inline-block;\\n\\twidth: 44px;\\n\\theight: 44px;\\n\\tposition: relative;\\n\\tvertical-align: top;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","import { render, staticRenderFns } from \"./MenuBubble.vue?vue&type=template&id=7a686b54&scoped=true&\"\nimport script from \"./MenuBubble.vue?vue&type=script&lang=js&\"\nexport * from \"./MenuBubble.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MenuBubble.vue?vue&type=style&index=0&id=7a686b54&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7a686b54\",\n  null\n  \n)\n\nexport default component.exports","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".menububble[data-v-7a686b54]{position:absolute;display:flex;z-index:10020;background:var(--color-main-background-translucent);box-shadow:0 1px 5px var(--color-box-shadow);border-radius:var(--border-radius-large);overflow:hidden;padding:0;margin-bottom:-3px;margin-left:10px;visibility:hidden;opacity:0;transform:translateX(-50%);transition:opacity 0.2s, visibility 0.2s;height:44px}.menububble.is-active[data-v-7a686b54]{opacity:1;visibility:visible}.menububble__button[data-v-7a686b54]{display:block;flex-grow:1;border:0;padding:0.9rem 0.7rem;margin:0;border-radius:0;cursor:pointer;background-color:var(--color-main-background);border-right:1px solid var(--color-border)}.menububble__button[data-v-7a686b54]:focus,.menububble__button[data-v-7a686b54]:hover{background-color:var(--color-background-hover);border:0;border-right:1px solid var(--color-border) !important}.menububble__button[data-v-7a686b54]:last-child{border:0 !important}.menububble__buttontext[data-v-7a686b54]{padding:0.4rem;padding-right:0}.menububble__form[data-v-7a686b54]{display:flex;align-items:center}.menububble__input[data-v-7a686b54]{font:inherit;border:none;background:transparent;min-width:150px}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/components/MenuBubble.vue\"],\"names\":[],\"mappings\":\"AA+IA,6BACC,iBAAkB,CAClB,YAAa,CACb,aAAc,CACd,mDAAoD,CACpD,4CAA6C,CAC7C,wCAAyC,CACzC,eAAgB,CAChB,SAAU,CACV,kBAAmB,CACnB,gBAAiB,CACjB,iBAAkB,CAClB,SAAU,CACV,0BAA2B,CAC3B,wCAAyC,CACzC,WAAY,CAfb,uCAkBE,SAAU,CACV,kBAAmB,CACnB,qCAGA,aAAc,CACd,WAAY,CACZ,QAAS,CACT,qBAAsB,CACtB,QAAS,CACT,eAAgB,CAChB,cAAe,CACf,6CAA8C,CAC9C,0CAA2C,CAT3C,sFAaC,8CAA+C,CAC/C,QAAS,CACT,qDAAsD,CAfvD,gDAmBC,mBAAoB,CACpB,yCAID,cAAe,CACf,eAAgB,CAChB,mCAGA,YAAa,CACb,kBAAmB,CACnB,oCAGA,YAAa,CACb,WAAY,CACZ,sBAAuB,CACvB,eAAgB\",\"sourcesContent\":[\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n.menububble {\\n\\tposition: absolute;\\n\\tdisplay: flex;\\n\\tz-index: 10020;\\n\\tbackground: var(--color-main-background-translucent);\\n\\tbox-shadow: 0 1px 5px var(--color-box-shadow);\\n\\tborder-radius: var(--border-radius-large);\\n\\toverflow: hidden;\\n\\tpadding: 0;\\n\\tmargin-bottom: -3px;\\n\\tmargin-left: 10px;\\n\\tvisibility: hidden;\\n\\topacity: 0;\\n\\ttransform: translateX(-50%);\\n\\ttransition: opacity 0.2s, visibility 0.2s;\\n\\theight: 44px;\\n\\n\\t&.is-active {\\n\\t\\topacity: 1;\\n\\t\\tvisibility: visible;\\n\\t}\\n\\n\\t&__button {\\n\\t\\tdisplay: block;\\n\\t\\tflex-grow: 1;\\n\\t\\tborder: 0;\\n\\t\\tpadding: 0.9rem 0.7rem;\\n\\t\\tmargin: 0;\\n\\t\\tborder-radius: 0;\\n\\t\\tcursor: pointer;\\n\\t\\tbackground-color: var(--color-main-background);\\n\\t\\tborder-right: 1px solid var(--color-border);\\n\\n\\t\\t&:focus,\\n\\t\\t&:hover {\\n\\t\\t\\tbackground-color: var(--color-background-hover);\\n\\t\\t\\tborder: 0;\\n\\t\\t\\tborder-right: 1px solid var(--color-border) !important;\\n\\t\\t}\\n\\n\\t\\t&:last-child {\\n\\t\\t\\tborder: 0 !important;\\n\\t\\t}\\n\\t}\\n\\n\\t&__buttontext {\\n\\t\\tpadding: 0.4rem;\\n\\t\\tpadding-right: 0;\\n\\t}\\n\\n\\t&__form {\\n\\t\\tdisplay: flex;\\n\\t\\talign-items: center;\\n\\t}\\n\\n\\t&__input {\\n\\t\\tfont: inherit;\\n\\t\\tborder: none;\\n\\t\\tbackground: transparent;\\n\\t\\tmin-width: 150px;\\n\\t}\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('EditorMenuBar',{attrs:{\"editor\":_vm.editor},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar commands = ref.commands;\nvar isActive = ref.isActive;\nvar focused = ref.focused;\nreturn [_c('div',{staticClass:\"menubar\",class:{ 'is-focused': focused, 'autohide': _vm.autohide }},[(_vm.isRichEditor)?_c('div',{ref:\"menubar\",staticClass:\"menubar-icons\"},[_vm._l((_vm.allIcons),function(icon,$index){return [(icon.class)?_c('button',{directives:[{name:\"show\",rawName:\"v-show\",value:($index < _vm.iconCount),expression:\"$index < iconCount\"}],key:icon.label,class:_vm.getIconClasses(isActive, icon),attrs:{\"title\":icon.label,\"disabled\":_vm.disabled(commands, icon)},on:{\"click\":function($event){return _vm.clickIcon(commands, icon)}}}):[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:($index < _vm.iconCount || !icon.class),expression:\"$index < iconCount || !icon.class\"},{name:\"click-outside\",rawName:\"v-click-outside\",value:(function () { return _vm.hideChildMenu(icon); }),expression:\"() => hideChildMenu(icon)\"}],key:icon.label,staticClass:\"submenu\"},[_c('button',{class:_vm.childIconClasses(isActive, icon.children ),attrs:{\"title\":icon.label},on:{\"click\":function($event){$event.preventDefault();return _vm.toggleChildMenu(icon)}}}),_vm._v(\" \"),_c('div',{staticClass:\"popovermenu menu-center\",class:{open: _vm.isChildMenuVisible(icon)}},[_c('PopoverMenu',{attrs:{\"menu\":_vm.childPopoverMenu(isActive, commands, icon.children, icon)}})],1)])]]}),_vm._v(\" \"),_c('Actions',[_vm._l((_vm.allIcons),function(icon,$index){return [(icon.class && _vm.isHiddenInMenu($index))?_c('ActionButton',{key:icon.class,attrs:{\"icon\":icon.class},on:{\"click\":function($event){return _vm.clickIcon(commands, icon)}}},[_vm._v(\"\\n\\t\\t\\t\\t\\t\\t\"+_vm._s(icon.label)+\"\\n\\t\\t\\t\\t\\t\")]):_vm._e()]})],2)],2):_vm._e(),_vm._v(\" \"),_vm._t(\"default\",[_vm._v(\"\\n\\t\\t\\tLeft side\\n\\t\\t\")])],2)]}}],null,true)})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuBar.vue?vue&type=style&index=0&id=0f96f50e&scoped=true&lang=scss&\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('EditorMenuBubble',{staticClass:\"menububble\",attrs:{\"editor\":_vm.editor},on:{\"hide\":_vm.hideLinkMenu},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar commands = ref.commands;\nvar isActive = ref.isActive;\nvar getMarkAttrs = ref.getMarkAttrs;\nvar menu = ref.menu;\nreturn [_c('div',{staticClass:\"menububble\",class:{ 'is-active': menu.isActive },style:((\"left: \" + (menu.left) + \"px; bottom: \" + (menu.bottom) + \"px;\"))},[(_vm.linkMenuIsActive)?_c('form',{staticClass:\"menububble__form\",on:{\"submit\":function($event){$event.preventDefault();return _vm.setLinkUrl(commands.link, _vm.linkUrl)}}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.linkUrl),expression:\"linkUrl\"}],ref:\"linkInput\",staticClass:\"menububble__input\",attrs:{\"type\":\"text\",\"placeholder\":\"https://\"},domProps:{\"value\":(_vm.linkUrl)},on:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"esc\",27,$event.key,[\"Esc\",\"Escape\"])){ return null; }return _vm.hideLinkMenu($event)},\"input\":function($event){if($event.target.composing){ return; }_vm.linkUrl=$event.target.value}}}),_vm._v(\" \"),_c('button',{staticClass:\"menububble__button icon-confirm\",attrs:{\"type\":\"button\",\"tabindex\":\"0\"},on:{\"click\":function($event){return _vm.setLinkUrl(commands.link, _vm.linkUrl)}}})]):[_c('button',{staticClass:\"menububble__button\",class:{ 'is-active': isActive.link() },on:{\"click\":function($event){_vm.showLinkMenu(getMarkAttrs('link'))}}},[_c('span',{staticClass:\"icon-link\"}),_vm._v(\" \"),_c('span',{staticClass:\"menububble__buttontext\"},[_vm._v(\"\\n\\t\\t\\t\\t\\t\"+_vm._s(_vm.t('text', isActive.link() ? 'Update Link' : 'Add Link'))+\"\\n\\t\\t\\t\\t\")])]),_vm._v(\" \"),_c('button',{staticClass:\"menububble__button\",class:{ 'is-active': isActive.link() },on:{\"click\":function($event){return _vm.selectFile(commands.link)}}},[_c('span',{staticClass:\"icon-file\"}),_vm._v(\" \"),_c('span',{staticClass:\"menububble__buttontext\"},[_vm._v(_vm._s(_vm.t('text', 'Link file')))])])]],2)]}}])})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/dist/cjs.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MenuBubble.vue?vue&type=style&index=0&id=7a686b54&scoped=true&lang=scss&\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};"],"sourceRoot":""}